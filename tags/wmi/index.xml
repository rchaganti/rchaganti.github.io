<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>WMI on Ravikanth Chaganti</title>
    <link>https://ravichaganti.com/tags/wmi/</link>
    <description>Recent content in WMI on Ravikanth Chaganti</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <lastBuildDate>Sun, 21 Aug 2011 00:00:00 +0000</lastBuildDate>
    <atom:link href="https://ravichaganti.com/tags/wmi/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Monitoring Volume Change Events in PowerShell using WMI</title>
      <link>https://ravichaganti.com/blog/monitoring-volume-change-events-in-powershell-using-wmi/</link>
      <pubDate>Sun, 21 Aug 2011 00:00:00 +0000</pubDate>
      <guid>https://ravichaganti.com/blog/monitoring-volume-change-events-in-powershell-using-wmi/</guid>
      <description>&lt;p&gt;While I was preparing a few demo scripts for a Bangalore IT Pro UG meet session, I tumbled upon on WMI event class Win32_VolumeChangeEvent. This one is interesting. It is derived from Win32_DeviceChangeEvent class and gives us the ability to monitor local drive events directly.For example, you can get a notification when a local drive or mount point gets removed or added. The following table shows a list of event types we can monitor.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Attaching scripts or tasks to Windows event log entries using PowerShell and WMI</title>
      <link>https://ravichaganti.com/blog/attaching-scripts-or-tasks-to-windows-event-log-entries-using-powershell-and-wmi/</link>
      <pubDate>Fri, 24 Jun 2011 00:00:00 +0000</pubDate>
      <guid>https://ravichaganti.com/blog/attaching-scripts-or-tasks-to-windows-event-log-entries-using-powershell-and-wmi/</guid>
      <description>&lt;p&gt;During a few load test iterations on a SharePoint farm, I started seeing some SQL exceptions in the application log of SharePoint servers. If you are familiar with SharePoint platform, you may have seen these events such as event ID &lt;a href=&#34;http://technet.microsoft.com/en-us/library/ee513066.aspx&#34;&gt;3355&lt;/a&gt;. This event complains that the SharePoint server cannot connect to SQL server. This need not really mean that the DB server is offline. So, to find out the real reason behind these event logs, I needed to start some trace activities whenever event ID 3355 gets logged.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Passing variables or arguments to an event action in PowerShell</title>
      <link>https://ravichaganti.com/blog/passing-variables-or-arguments-to-an-event-action-in-powershell/</link>
      <pubDate>Wed, 22 Jun 2011 00:00:00 +0000</pubDate>
      <guid>https://ravichaganti.com/blog/passing-variables-or-arguments-to-an-event-action-in-powershell/</guid>
      <description>&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt;: Based on feedback from @ShayLevy, we don’t have to send the background job object to Event action as a variable. It is already available as $event.Sender or just $sender. You can see that in the image below. I just picked up a wrong example to explain the -MessageData parameter. Although, the article originally showed a background job as an example, it was just to show how &lt;em&gt;&lt;strong&gt;any&lt;/strong&gt;&lt;/em&gt; object can be passed to event action. For example, if all you want to access is a background job object which you are monitoring using Register-ObjectEvent, you can access the job name using $event.Sender.Name or $sender.Name, job Id using $event.Sender.Id or $sender.Id, and so on.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Monitoring file creation using WMI and PowerEvents module</title>
      <link>https://ravichaganti.com/blog/monitoring-file-creation-using-wmi-and-powerevents-module/</link>
      <pubDate>Wed, 19 Jan 2011 00:00:00 +0000</pubDate>
      <guid>https://ravichaganti.com/blog/monitoring-file-creation-using-wmi-and-powerevents-module/</guid>
      <description>&lt;p&gt;There are several ways we can create a file monitoring script using PowerShell. There is also a cmdlet in PowerShellPack called Start-FileSystemWatcher to monitor file /folder changes. However, none of these methods survive a exit at the console or wherever the script is running. This is because all these methods create a temporary event consumer. As I’d mentioned in an earlier post, &lt;a href=&#34;http://www.twitter.com/pcgeek86&#34;&gt;Trevor’s &lt;/a&gt;&lt;a href=&#34;http://powerevents.codeplex.com/&#34;&gt;PowerEvents&lt;/a&gt; module makes it very easy to create permanent event consumers in PowerShell. In today’s post, we shall look at how we can do that.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Creating complex scheduled tasks using WMI Timer events and PowerEvents Module</title>
      <link>https://ravichaganti.com/blog/creating-complex-scheduled-tasks-using-wmi-timer-events-and-powerevents-module/</link>
      <pubDate>Sat, 25 Dec 2010 00:00:00 +0000</pubDate>
      <guid>https://ravichaganti.com/blog/creating-complex-scheduled-tasks-using-wmi-timer-events-and-powerevents-module/</guid>
      <description>&lt;p&gt;A few weeks ago, I wrote about &lt;a href=&#34;http://139.59.40.198/blog/?p=1751&#34;&gt;WMI Timer events using Win32_LocalTime&lt;/a&gt; and then mentioned how to &lt;a href=&#34;http://139.59.40.198/blog/?p=1773&#34;&gt;work around the DayOfWeek issue&lt;/a&gt;. In today’s post, I will show you how to use WMI timer events to create complex scheduled tasks.&lt;/p&gt;&#xA;&lt;p&gt;As system administrators, you may have to create scheduled jobs for performing various sysadmin tasks. We generally use Task Scheduler for such jobs. However, using the regular OS task scheduler, there is no easy way to create a scheduled task that occurs — for example — &lt;strong&gt;every Thursday of every fourth week of a month in the third quarter of every year.&lt;/strong&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>WMI Query Language (WQL) – Event Queries: Extrinsic Events</title>
      <link>https://ravichaganti.com/blog/wmi-query-language-wql-event-queries-extrinsic-events/</link>
      <pubDate>Fri, 24 Dec 2010 00:00:00 +0000</pubDate>
      <guid>https://ravichaganti.com/blog/wmi-query-language-wql-event-queries-extrinsic-events/</guid>
      <description>&lt;p&gt;In this part of the WQL series, we shall look at extrinsic events.&lt;/p&gt;&#xA;&lt;p&gt;Extrinsic events represent events that do not directly link to standard WMI model. For example, Windows registry defines extrinsic events for all registry change events. For intrinsic events, having a WMI provider isn’t mandatory. This is mostly because they are defined within the standard WMI model and WMI takes care of these if there is no WMI provider for a given resource in the standard WMI model. However, since extrinsic events are outside of the standard WMI model, having a WMI provider is mandatory.&lt;/p&gt;</description>
    </item>
    <item>
      <title>WMI Query Language (WQL) – Schema Queries</title>
      <link>https://ravichaganti.com/blog/wmi-query-language-wql-schema-queries/</link>
      <pubDate>Fri, 24 Dec 2010 00:00:00 +0000</pubDate>
      <guid>https://ravichaganti.com/blog/wmi-query-language-wql-schema-queries/</guid>
      <description>&lt;p&gt;In this last and final part of this series, we will look at how to use WQL for querying the WMI schema.&lt;/p&gt;&#xA;&lt;p&gt;Schema queries are used to retrieve class definitions (rather than class instances) and schema associations. In simple words, if you need to find out what type of information (this is what schema really means) a specific class holds, you use schema queries.Here is an example of a schema query:&lt;/p&gt;</description>
    </item>
    <item>
      <title>WMI Query Language (WQL) – Event Queries: Intrinsic Events</title>
      <link>https://ravichaganti.com/blog/wmi-query-language-wql--event-queries-intrinsic-events/</link>
      <pubDate>Wed, 22 Dec 2010 00:00:00 +0000</pubDate>
      <guid>https://ravichaganti.com/blog/wmi-query-language-wql--event-queries-intrinsic-events/</guid>
      <description>&lt;p&gt;&lt;strong&gt;Intrinsic events&lt;/strong&gt; are used to monitor a resource represented by a class in the CIM repository. In other words, the intrinsic events occur in response to a change in the standard WMI data model. WMI creates intrinsic events for objects stored in the WMI repository. A provider generates intrinsic events for dynamic classes, but WMI can create an instance for a dynamic class if no provider is available. WMI uses polling to detect the changes.&lt;/p&gt;</description>
    </item>
    <item>
      <title>WMI Query Language (WQL) – Event Queries: Syntax</title>
      <link>https://ravichaganti.com/blog/wmi-query-language-wql-event-queries-syntax/</link>
      <pubDate>Wed, 22 Dec 2010 00:00:00 +0000</pubDate>
      <guid>https://ravichaganti.com/blog/wmi-query-language-wql-event-queries-syntax/</guid>
      <description>&lt;p&gt;The WMI query syntax for event queries is a bit different and deserves a discussion. So, before we delve in to the types of event queries, let us first look at the syntax for WQL event queries. As we discussed &lt;a href=&#34;http://139.59.40.198/blog/?p=1508&#34;&gt;earlier&lt;/a&gt;, we use SELECT statement for event queries too. We can combine this with other keywords such as WITHIN, HAVING, and GROUP to change how we receive these WMI events.&lt;/p&gt;&#xA;&lt;p&gt;Here is how a &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/cc250721(v=PROT.10).aspx&#34;&gt;MSDN article&lt;/a&gt; shows the syntax for WMI event queries.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Workarounds for DayOfWeek Timer events when using Win32_LocalTime</title>
      <link>https://ravichaganti.com/blog/workarounds-for-dayofweek-timer-events-when-using-win32_localtime/</link>
      <pubDate>Fri, 03 Dec 2010 00:00:00 +0000</pubDate>
      <guid>https://ravichaganti.com/blog/workarounds-for-dayofweek-timer-events-when-using-win32_localtime/</guid>
      <description>&lt;p&gt;In my &lt;a href=&#34;http://139.59.40.198/blog/?p=1751&#34;&gt;earlier post&lt;/a&gt;, I showed how Win32_LocalTime WMI class can be used to capture timer events. As mentioned there, WMI events can be quite helpful in creating complex scheduling tasks. For example, you can specify to run a script every Thursday of every fourth week of a month in the third quarter of every year. However, there is a bug in Win32_LocalTime that currently blocks this.&lt;/p&gt;&#xA;&lt;p&gt;I created a support incident with MS and reported this bug to them. I got a response that this indeed is a bug and they provided a workaround to solve this temporarily.&lt;/p&gt;</description>
    </item>
    <item>
      <title>WMI Timer Events in PowerShell using Win32_LocalTime</title>
      <link>https://ravichaganti.com/blog/wmi-timer-events-in-powershell-using-win32_localtime/</link>
      <pubDate>Wed, 24 Nov 2010 00:00:00 +0000</pubDate>
      <guid>https://ravichaganti.com/blog/wmi-timer-events-in-powershell-using-win32_localtime/</guid>
      <description>&lt;p&gt;This is not a part of the &lt;a href=&#34;http://139.59.40.198/blog/?cat=261&#34;&gt;WQL series&lt;/a&gt; I am doing. I happend to take a look at the WMI timer events while providing feedback to an upcoming (cool) &lt;a href=&#34;http://powerevents.codeplex.com/&#34;&gt;PowerEvents&lt;/a&gt; module by &lt;a href=&#34;http://trevorsullivan.net/&#34;&gt;Trevor&lt;/a&gt; (@pcgeek86). BTW, this module will be released on November 30th. So, watch out for the annoncement.&lt;/p&gt;&#xA;&lt;p&gt;Coming to the subject of this post, in WMI, there are 3 types of events possible. They are Timer events, Intrinsic events, and extrinsic events. My WQL series will soon cover intrinsic and extrensic events. Very few people have written about WMI timer events in the past but &lt;a href=&#34;http://theadminblog.blogspot.com/2009_02_01_archive.html&#34;&gt;this &lt;/a&gt;particular post on &lt;a href=&#34;http://theadminblog.blogspot.com/&#34;&gt;The SysAdmins blog &lt;/a&gt;discusses good amount of details.&lt;/p&gt;</description>
    </item>
    <item>
      <title>WMI Query Language (WQL) – Event Queries: Introduction</title>
      <link>https://ravichaganti.com/blog/wmi-query-language-wql--event-queries-introduction/</link>
      <pubDate>Mon, 15 Nov 2010 00:00:00 +0000</pubDate>
      <guid>https://ravichaganti.com/blog/wmi-query-language-wql--event-queries-introduction/</guid>
      <description>&lt;p&gt;In this post, I will write a bit about basics of WMI events and how Register-WMIEvent cmdlet can be used. To start with, here is an excerpt from &lt;a href=&#34;http://technet.microsoft.com/en-us/library/ee156572.aspx&#34;&gt;Microsoft Scripting guide&lt;/a&gt; that introduces WMI events:&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Just as there is a WMI class that represents each type of system resource that can be managed using WMI, there is a WMI class that represents each type of WMI event. When an event that can be monitored by WMI occurs, an instance of the corresponding WMI event class is created. A &lt;em&gt;WMI event&lt;/em&gt; occurs when that instance is created.&lt;/p&gt;</description>
    </item>
    <item>
      <title>WMI Query Language (WQL) – Data Queries: References Of</title>
      <link>https://ravichaganti.com/blog/wmi-query-language-wql-data-queries-references-of/</link>
      <pubDate>Thu, 11 Nov 2010 00:00:00 +0000</pubDate>
      <guid>https://ravichaganti.com/blog/wmi-query-language-wql-data-queries-references-of/</guid>
      <description>&lt;p&gt;Per MSDN documentation, the REFERENCES OF statement&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Retrieves all association instances that refer to a particular source instance. The REFERENCES OF statement is similar to the ASSOCIATORS OF statement in its syntax. However, rather than retrieving endpoint instances, it retrieves the intervening association instances.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;That is very cryptic for beginners like you and me. So, let us look at an example to understand this.&lt;/p&gt;&#xA;&lt;figure class=&#34;figure &#34; style=&#34;max-width: 100%; margin: 1.5rem auto;&#34;&gt;&#xA;  &lt;a href=&#34;https://ravichaganti.com/images/WQL5-1.png&#34; class=&#34;glightbox&#34; data-gallery=&#34;post-images&#34; data-glightbox=&#34;description: &#34;&gt;&#xA;    &lt;img src=&#34;https://ravichaganti.com/images/WQL5-1.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34; style=&#34;width: 100%; height: auto; border-radius: 0.5rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);&#34;&gt;&#xA;  &lt;/a&gt;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;If you look at the above diagram (captured from the associations tab of Win32_Process in CIM Studio) and as I showed you in my &lt;a href=&#34;http://139.59.40.198/blog/?p=1580&#34;&gt;earlier post&lt;/a&gt;, Win32_SessionProcess, in32_NamedJobObjectProcesses, Win32_SystemProcesses are the associator or association classes. Whereas, Win32_Process, Win32_LogonSession, Win32_NamedObject, and Win32_ComputerSystem are the associated classes.&lt;/p&gt;</description>
    </item>
    <item>
      <title>WMI Query Language (WQL) – Data Queries: Associators Of</title>
      <link>https://ravichaganti.com/blog/wmi-query-language-wql-data-queries-associators-of/</link>
      <pubDate>Mon, 13 Sep 2010 00:00:00 +0000</pubDate>
      <guid>https://ravichaganti.com/blog/wmi-query-language-wql-data-queries-associators-of/</guid>
      <description>&lt;p&gt;As we saw in the previous post, Select queries can be used to retrieve instances of WMI class. But select queries are not the only way to query for instances. We can also use &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/aa384793(v=VS.85).aspx&#34;&gt;Associators Of&lt;/a&gt; keyword to the same. However, there is a difference. Select queries always return a collection of instances of a WMI class where as “Associators Of” returns a collection of WMI objects that belong to different WMI classes or associated WMI classes. Before we dig too much in to this, let us first understand what are associated WMI classes.&lt;/p&gt;</description>
    </item>
    <item>
      <title>WMI Query Language (WQL) – Data Queries: SELECT, FROM, and WHERE</title>
      <link>https://ravichaganti.com/blog/wmi-query-language-wql-data-queries-select-from-and-where/</link>
      <pubDate>Tue, 03 Aug 2010 00:00:00 +0000</pubDate>
      <guid>https://ravichaganti.com/blog/wmi-query-language-wql-data-queries-select-from-and-where/</guid>
      <description>&lt;p&gt;In this part of the series on WQL, we will look at what are data queries and how some of the WQL keywords &amp;amp; operators can be used to retrieve information from WMI repository. Also, as mentioned earlier, there are many other tools that consume WQL queries to retrieve information from WMI. However, in this series, I shall use only PowerShell to demonstrate WQL.&lt;/p&gt;&#xA;&lt;p&gt;WQL data queries are the most simplest form of querying for WMI data. Data queries are used to retrieve class instances and data associations. For example,&lt;/p&gt;</description>
    </item>
    <item>
      <title>WMI Query Language (WQL) – Keywords and Operators</title>
      <link>https://ravichaganti.com/blog/wmi-query-language-wql-keywords-and-operators/</link>
      <pubDate>Mon, 02 Aug 2010 00:00:00 +0000</pubDate>
      <guid>https://ravichaganti.com/blog/wmi-query-language-wql-keywords-and-operators/</guid>
      <description>&lt;p&gt;In this post, we will look at the a brief description of WQL keywords and operators and see a classification of the keywords based on where (query types) these keywords can be used.&lt;/p&gt;&#xA;&lt;h3 id=&#34;keywords&#34;&gt;Keywords&lt;/h3&gt;&#xA;&lt;p&gt;Similar to SQL, WQL queries use keywords to retrieve data from the management objects. WQL has 19 keywords to perform these queries against WMI repositories. In the previous post, we discussed about three types of queries: Data, Event, and Schema. Though there are 19 WQL keywords, only a few of them can be used all 3 possible query types. The following table lists all the WQL keywords and lists the query type in which they can be used.&lt;/p&gt;</description>
    </item>
    <item>
      <title>WMI Query Language (WQL) – An introduction</title>
      <link>https://ravichaganti.com/blog/wmi-query-language-wql-an-introduction/</link>
      <pubDate>Thu, 22 Jul 2010 00:00:00 +0000</pubDate>
      <guid>https://ravichaganti.com/blog/wmi-query-language-wql-an-introduction/</guid>
      <description>&lt;p&gt;I have been using &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/aa394582(v=VS.85).aspx&#34;&gt;WMI &lt;/a&gt;a lot these days and got to play with &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/aa392902(v=VS.85).aspx&#34;&gt;WQL &lt;/a&gt;as well. In this series of posts, I want to write about how &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/aa394606(VS.85).aspx&#34;&gt;WMI Query Language (WQL)&lt;/a&gt; can be used to retrieve management data exposed by WMI. Yes, this has nothing to do with PowerShell but as a PowerShell lover (and a &lt;a href=&#34;https://mvp.support.microsoft.com/profile=0B78975F-D499-467B-A2C0-2182990E8513&#34;&gt;MVP &lt;/a&gt;now), I will use PowerShell for all my examples.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;&lt;a href=&#34;http://msdn.microsoft.com/en-us/library/aa394572(v=VS.85).aspx&#34;&gt;Windows Management Instrumentation (WMI)&lt;/a&gt; is the Microsoft implementation of Web-based Enterprise Management (WBEM), which is an industry initiative to develop a standard technology for accessing management information in an enterprise environment. WMI uses the Common Information Model (CIM) industry standard to represent systems, applications, networks, devices, and other managed components. CIM is developed and maintained by the Distributed Management Task Force (&lt;a href=&#34;http://go.microsoft.com/fwlink/?LinkId=67786&#34;&gt;DMTF&lt;/a&gt;). We can write WMI scripts to automate several tasks on local or remote computer(s).&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
