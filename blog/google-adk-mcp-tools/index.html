<!DOCTYPE html>
<html lang="en-us">
<head>
  
  <script>
    (function() {
      const stored = localStorage.getItem('theme-preference');
      const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      const theme = stored || (prefersDark ? 'dark' : 'light');

      if (theme === 'dark') {
        document.documentElement.classList.add('dark');
      }
    })();
  </script>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <title>Google ADK - MCP tools | Ravikanth Chaganti</title>

  
  <meta name="description" content="Consider you are building an agent that needs to interact with a company&rsquo;s database, pull data from a third-party API, and read files from a shared drive. Without a standard protocol, you would end up writing custom integration code for each backend. Every new tool means a new adapter. Every new agent that needs the same tool means duplicating that adapter. This approach does not scale. The Model Context Protocol (MCP) solves this by providing a universal standard for how agents connect to external tools and data sources. With MCP, a tool is built once, and any MCP-compatible agent can discover and use it. Google ADK has first-class support for MCP, enabling your agents to both consume tools from MCP servers and expose their own tools as MCP servers.">
  <meta name="author" content="Ravikanth Chaganti">

  
  
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  

  
  <meta property="og:title" content="Google ADK - MCP tools">
  <meta property="og:description" content="Consider you are building an agent that needs to interact with a company&rsquo;s database, pull data from a third-party API, and read files from a shared drive. Without a standard protocol, you would end up writing custom integration code for each backend. Every new tool means a new adapter. Every new agent that needs the same tool means duplicating that adapter. This approach does not scale. The Model Context Protocol (MCP) solves this by providing a universal standard for how agents connect to external tools and data sources. With MCP, a tool is built once, and any MCP-compatible agent can discover and use it. Google ADK has first-class support for MCP, enabling your agents to both consume tools from MCP servers and expose their own tools as MCP servers.">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://ravichaganti.com/blog/google-adk-mcp-tools/">
  <meta property="og:site_name" content="Ravikanth Chaganti">
  <meta property="og:locale" content="en_US">
  
  <meta property="og:image" content="https://ravichaganti.com/images/adk.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:alt" content="Google ADK - MCP tools">

  
  
    <meta property="article:published_time" content="2025-12-20T00:00:00Z">
    <meta property="article:modified_time" content="2025-12-20T00:00:00Z">
    <meta property="article:author" content="Ravikanth Chaganti">
    <meta property="article:section" content="Google">
    
  

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Google ADK - MCP tools">
  <meta name="twitter:description" content="Consider you are building an agent that needs to interact with a company&rsquo;s database, pull data from a third-party API, and read files from a shared drive. Without a standard protocol, you would end up writing custom integration code for each backend. Every new tool means a new adapter. Every new agent that needs the same tool means duplicating that adapter. This approach does not scale. The Model Context Protocol (MCP) solves this by providing a universal standard for how agents connect to external tools and data sources. With MCP, a tool is built once, and any MCP-compatible agent can discover and use it. Google ADK has first-class support for MCP, enabling your agents to both consume tools from MCP servers and expose their own tools as MCP servers.">
  <meta name="twitter:image" content="https://ravichaganti.com/images/adk.png">
  <meta name="twitter:site" content="@ravikanth">

  
  <link rel="canonical" href="https://ravichaganti.com/blog/google-adk-mcp-tools/">

  
  <link rel="alternate" type="application/rss+xml" href="https://ravichaganti.com/index.xml">

  
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="alternate icon" type="image/x-icon" href="/favicon.ico">

  
  <link rel="stylesheet" href="/css/main.css">

  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

  
  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Google ADK - MCP tools",
  "description": "Consider you are building an agent that needs to interact with a company\u0026rsquo;s database, pull data from a third-party API, and read files from a shared drive. Without a standard protocol, you would …",
  "articleBody": "\"Consider you are building an agent that needs to interact with a company\\u0026rsquo;s database, pull data from a third-party API, and read files from a shared drive. Without a standard protocol, you would end up writing custom integration code for each backend. Every new tool means a new adapter. Every new agent that needs the same tool means duplicating that adapter. This approach does not scale. The Model Context Protocol (MCP) solves this by providing a universal standard for how agents connect to external tools and data sources. With MCP, a tool is built once, and any MCP-compatible agent can discover and use it. Google ADK has first-class support for MCP, enabling your agents to both consume tools from MCP servers and expose their own tools as MCP servers.\\nWhat is MCP? MCP is an open standard initiated by Anthropic that defines how LLMs communicate with external applications, data sources, and tools. It follows a client-server architecture. An MCP server exposes capabilities such as data (resources), interaction templates (prompts), and executable functions (tools). An MCP client, which in our case is the ADK agent, connects to the server, discovers what it offers, and uses those capabilities as if they were native.\\nThe key benefit is standardization. Instead of building one-off integrations for every external system, you write an MCP server once, and any MCP client can talk to it. Conversely, your ADK agent, acting as a client, can connect to any MCP server without needing to know the implementation details behind it.\\nADK supports two primary integration patterns with MCP.\\nConsuming MCP servers: Your ADK agent acts as an MCP client, using the tools provided by an external MCP server. Exposing ADK tools via an MCP server: You wrap your existing ADK tools inside an MCP server, making them accessible to any MCP-compatible client, not just ADK agents. Consuming MCP servers This is the most common pattern. You have an existing MCP server, one from the community, a cloud-managed service, or one you built for another application, and you want your ADK agent to use its tools.\\nMcpToolset McpToolset is the class at the heart of ADK\\u0026rsquo;s MCP integration. When you add an McpToolset instance to your agent\\u0026rsquo;s tools list, it handles the entire lifecycle behind the scenes.\\nResponsibility What happens Connection management Establishes and maintains the connection to the MCP server, and tears it down on shutdown Tool discovery Queries the server for its available tools via the MCP list_tools method Schema adaptation Converts each discovered MCP tool schema into an ADK-compatible BaseTool instance Transparent proxying When the LLM invokes a discovered tool, McpToolset forwards the call via the MCP call_tool method Filtering Selectively exposes only the tools you want, instead of all the tools the server advertises The connection to an MCP server can use one of three transport mechanisms.\\nTransport Class Use case Standard I/O (Stdio) StdioConnectionParams The MCP server runs as a local subprocess; communication via stdin/stdout Server-Sent Events (SSE) SseConnectionParams The MCP server is a remote HTTP service using the legacy SSE transport Streamable HTTP StreamableHTTPConnectionParams The MCP server is a remote HTTP service using the newer single-endpoint transport Connecting via Stdio Stdio is the simplest transport. The MCP server runs as a child process on the same machine, and ADK communicates with it through standard input and output pipes. Many community MCP servers distributed as Node.js packages use this model.\\nHere is an example that connects an ADK agent to the community filesystem MCP server. This server provides tools for listing directories, reading files, and performing other file operations.\\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 import os from google.adk.agents import LlmAgent from google.adk.tools.mcp_tool import McpToolset from google.adk.tools.mcp_tool.mcp_session_manager import StdioConnectionParams from mcp import StdioServerParameters from dotenv import load_dotenv load_dotenv() ACCESSIBLE_FOLDER = \\u0026#34;C:/GitHub/google-adk-101\\u0026#34; root_agent = LlmAgent( model=\\u0026#34;gemini-2.0-flash\\u0026#34;, name=\\u0026#34;file_assistant\\u0026#34;, instruction=f\\u0026#34;\\u0026#34;\\u0026#34;Help the user manage files. You can list directories, read files, and search for content. You have access to the directory: {ACCESSIBLE_FOLDER} Always use the full absolute path when calling filesystem tools. Use list_directory first to explore, then read specific files.\\u0026#34;\\u0026#34;\\u0026#34;, tools=[ McpToolset( connection_params=StdioConnectionParams( server_params=StdioServerParameters( command=\\u0026#34;npx.cmd\\u0026#34;, args=[ \\u0026#34;-y\\u0026#34;, \\u0026#34;@modelcontextprotocol/server-filesystem\\u0026#34;, ACCESSIBLE_FOLDER, ], ), timeout=60, ), ) ], ) When this agent starts, McpToolset spawns npx @modelcontextprotocol/server-filesystem as a subprocess, queries it for tools, and makes them available to the LLM. The agent can now respond to prompts such as \\u0026ldquo;list all Python files in my project directory\\u0026rdquo; or \\u0026ldquo;show me the contents of config.yaml\\u0026rdquo; without any custom tool code.\\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 \\u0026gt; adk run .\\\\mcp_agent\\\\ Running agent file_assistant, type exit to exit. [user]: list files in mcp_agent folder [file_assistant]: Okay, I see the following files and directories in the `mcp_agent` folder: * `.adk` (directory) * `agent.py` (file) * `__init__.py` (file) * `__pycache__` (directory) Is there anything specific you\\u0026#39;d like me to do with these files? For example, I can read the content of `agent.py` or any other file. [user]: Connecting via SSE When the MCP server is running remotely as a standalone HTTP service, you use SseConnectionParams. SSE (Server-Sent Events) was the original network transport for MCP. It uses two separate HTTP endpoints, one for the client to send requests (POST) and another where the client establishes a persistent SSE connection (GET) to receive streaming responses.\\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 from google.adk.agents import LlmAgent from google.adk.tools.mcp_tool import McpToolset from google.adk.tools.mcp_tool.mcp_session_manager import SseConnectionParams root_agent = LlmAgent( model=\\u0026#34;gemini-2.0-flash\\u0026#34;, name=\\u0026#34;wiki_agent\\u0026#34;, instruction=\\u0026#34;Help users retrieve and summarize Wikipedia articles.\\u0026#34;, tools=[ McpToolset( connection_params=SseConnectionParams( url=\\u0026#34;http://localhost:8001/sse\\u0026#34;, headers={\\u0026#34;Authorization\\u0026#34;: \\u0026#34;Bearer my-api-token\\u0026#34;}, timeout=30, ), ) ], ) The SseConnectionParams accept url, optional headers for authentication, a timeout for the initial connection, and an sse_read_timeout for the streaming read.\\nConnecting via Streamable HTTP In March 2025, the MCP specification introduced Streamable HTTP as the successor to SSE. Instead of two separate endpoints, Streamable HTTP uses a single HTTP endpoint for both sending requests and receiving responses. This simplifies deployment and works better with standard HTTP infrastructure, such as load balancers and reverse proxies.\\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 import os from google.adk.agents import LlmAgent from google.adk.tools.mcp_tool import MCPToolset, StreamableHTTPConnectionParams root_agent = LlmAgent( model=\\u0026#34;gemini-2.0-flash\\u0026#34;, name=\\u0026#34;github_agent\\u0026#34;, instruction=\\u0026#34;Help users work with GitHub repositories, issues, and pull requests.\\u0026#34;, tools=[ MCPToolset( connection_params=StreamableHTTPConnectionParams( url=\\u0026#34;https://api.githubcopilot.com/mcp/\\u0026#34;, headers={ \\u0026#34;Authorization\\u0026#34;: \\u0026#34;Bearer \\u0026#34; + os.environ[\\u0026#34;GITHUB_TOKEN\\u0026#34;], }, ), ) ], ) For new MCP server integrations, prefer Streamable HTTP over SSE when the server supports it.\\n1 2 3 4 5 6 7 8 \\u0026gt; adk run .\\\\mcp_agent\\\\ Running agent github_agent, type exit to exit. [user]: get rchaganti/dscresources info [github_agent]: The repository name is DSCResources, full name is rchaganti/DSCResources, description is Custom DSC resource modules by PowerShell Magazine, the language is PowerShell, it has 62 stars, 26 forks, and 13 open issues. It was created on 2014-10-13T07:06:17Z and updated on 2024-10-24T03:19:14Z. It is a public repository and the default branch is master. [user]: Filtering tools An MCP server might expose dozens of tools, but your agent may only need a handful. Exposing unnecessary tools to the LLM increases token consumption and can confuse the model\\u0026rsquo;s tool selection. The tool_filter parameter on McpToolset lets you whitelist only the tools you need.\\n1 2 3 4 5 6 7 8 9 McpToolset( connection_params=StdioConnectionParams( server_params=StdioServerParameters( command=\\u0026#34;npx\\u0026#34;, args=[\\u0026#34;-y\\u0026#34;, \\u0026#34;@modelcontextprotocol/server-filesystem\\u0026#34;, \\u0026#34;/home/user/data\\u0026#34;], ), ), tool_filter=[\\u0026#34;read_file\\u0026#34;, \\u0026#34;list_directory\\u0026#34;], ) With this filter, even if the filesystem server exposes tools for writing, moving, or deleting files, only read_file and list_directory will be available to the agent. This is a good practice for both security and performance.\\nUsing McpToolset outside adk web When you are running your own application loop instead of using adk web, the setup requires a bit more care around async initialization and connection cleanup. The McpToolset must be created asynchronously, and you need to manage the connection lifecycle properly.\\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 import asyncio from google.adk.agents import LlmAgent from google.adk.sessions import InMemorySessionService from google.adk.runners import Runner from google.adk.tools.mcp_tool import McpToolset from google.adk.tools.mcp_tool.mcp_session_manager import StdioConnectionParams from mcp import StdioServerParameters from google.genai.types import Content, Part async def main(): toolset = McpToolset( connection_params=StdioConnectionParams( server_params=StdioServerParameters( command=\\u0026#34;npx\\u0026#34;, args=[\\u0026#34;-y\\u0026#34;, \\u0026#34;@modelcontextprotocol/server-filesystem\\u0026#34;, \\u0026#34;C:\\\\\\\\github\\\\\\\\google-adk-101\\u0026#34;], ), ), tool_filter=[\\u0026#34;read_file\\u0026#34;, \\u0026#34;list_directory\\u0026#34;], ) agent = LlmAgent( model=\\u0026#34;gemini-2.0-flash\\u0026#34;, name=\\u0026#34;file_reader\\u0026#34;, instruction=\\u0026#34;You help users explore files.\\u0026#34;, tools=[toolset], ) session_service = InMemorySessionService() runner = Runner( agent=agent, app_name=\\u0026#34;mcp_demo\\u0026#34;, session_service=session_service, ) session = await session_service.create_session( app_name=\\u0026#34;mcp_demo\\u0026#34;, user_id=\\u0026#34;user1\\u0026#34; ) user_msg = Content( parts=[ Part( text=\\u0026#34;What files are in mcp_agent folder?\\u0026#34; ) ] ,role=\\u0026#34;user\\u0026#34; ) async for event in runner.run_async( user_id=\\u0026#34;user1\\u0026#34;, session_id=session.id, new_message=user_msg ): if event.is_final_response() and event.content and event.content.parts: print(f\\u0026#34;Agent: {event.content.parts[0].text}\\u0026#34;) asyncio.run(main()) When using McpToolset directly in adk web, the framework handles connection setup and teardown automatically. In standalone applications like the one above, the Runner manages the lifecycle of the toolset.\\n1 2 3 \\u0026gt; python.exe .\\\\mcp_agent\\\\agent.py Agent: Okay, the files in the mcp_agent folder are: .adk (directory), agent.py, __init__.py, and __pycache__ (directory). Connecting to multiple MCP servers An agent can consume tools from several MCP servers simultaneously. Each McpToolset manages its own independent connection. You simply list multiple toolsets in the agent\\u0026rsquo;s tools parameter.\\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 import os from google.adk.agents import LlmAgent from google.adk.tools.mcp_tool import McpToolset, MCPToolset, StreamableHTTPConnectionParams from google.adk.tools.mcp_tool.mcp_session_manager import StdioConnectionParams from mcp import StdioServerParameters root_agent = LlmAgent( model=\\u0026#34;gemini-2.0-flash\\u0026#34;, name=\\u0026#34;research_assistant\\u0026#34;, instruction=\\u0026#34;\\u0026#34;\\u0026#34;You are a research assistant. Use the filesystem tools to read local notes, and the GitHub tools to look up repository information.\\u0026#34;\\u0026#34;\\u0026#34;, tools=[ # Local filesystem server McpToolset( connection_params=StdioConnectionParams( server_params=StdioServerParameters( command=\\u0026#34;npx\\u0026#34;, args=[\\u0026#34;-y\\u0026#34;, \\u0026#34;@modelcontextprotocol/server-filesystem\\u0026#34;, \\u0026#34;C:\\\\\\\\Github\\\\\\\\google-adk-101\\u0026#34;], ), ), tool_filter=[\\u0026#34;read_file\\u0026#34;, \\u0026#34;list_directory\\u0026#34;], ), # Remote GitHub server MCPToolset( connection_params=StreamableHTTPConnectionParams( url=\\u0026#34;https://api.githubcopilot.com/mcp/\\u0026#34;, headers={\\u0026#34;Authorization\\u0026#34;: \\u0026#34;Bearer \\u0026#34; + os.environ[\\u0026#34;GITHUB_TOKEN\\u0026#34;]}, ), ), ], ) The LLM sees all the tools from both servers in a single flat list and can combine them freely within a single conversation.\\nExposing ADK tools as an MCP server The second integration pattern is the reverse direction. You have tool functions built with ADK, and you want to make them available to any MCP client, not just ADK agents. This is useful when other teams or frameworks in your organization need access to the same tools.\\nADK provides a conversion utility, adk_to_mcp_tool_type, that translates ADK tool definitions into MCP-compatible schemas. You then wrap these inside a standard MCP server built with the mcp Python library.\\nBuilding the MCP server Here is a complete example. We will create a simple ADK tool that checks the health of a set of service endpoints, then expose it through an MCP server.\\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 # health_check_mcp_server.py import asyncio import json from mcp import types as mcp_types from mcp.server.lowlevel import Server, NotificationOptions from mcp.server.models import InitializationOptions import mcp.server.stdio from google.adk.tools.function_tool import FunctionTool from google.adk.tools.mcp_tool.conversion_utils import adk_to_mcp_tool_type def check_service_health(service_name: str) -\\u0026gt; dict: \\u0026#34;\\u0026#34;\\u0026#34;Checks the health status of a named service.\\u0026#34;\\u0026#34;\\u0026#34; # In a real application, this would ping the actual service health_data = { \\u0026#34;payments\\u0026#34;: {\\u0026#34;status\\u0026#34;: \\u0026#34;healthy\\u0026#34;, \\u0026#34;latency_ms\\u0026#34;: 45, \\u0026#34;uptime\\u0026#34;: \\u0026#34;99.97%\\u0026#34;}, \\u0026#34;inventory\\u0026#34;: {\\u0026#34;status\\u0026#34;: \\u0026#34;degraded\\u0026#34;, \\u0026#34;latency_ms\\u0026#34;: 320, \\u0026#34;uptime\\u0026#34;: \\u0026#34;98.5%\\u0026#34;}, \\u0026#34;auth\\u0026#34;: {\\u0026#34;status\\u0026#34;: \\u0026#34;healthy\\u0026#34;, \\u0026#34;latency_ms\\u0026#34;: 12, \\u0026#34;uptime\\u0026#34;: \\u0026#34;99.99%\\u0026#34;}, } result = health_data.get( service_name.lower(), {\\u0026#34;status\\u0026#34;: \\u0026#34;unknown\\u0026#34;, \\u0026#34;error\\u0026#34;: f\\u0026#34;No service found with name \\u0026#39;{service_name}\\u0026#39;\\u0026#34;} ) result[\\u0026#34;service\\u0026#34;] = service_name return result # Wrap the Python function as an ADK FunctionTool health_tool = FunctionTool(check_service_health) # Create the MCP server app = Server(\\u0026#34;health-check-server\\u0026#34;) @app.list_tools() async def list_tools() -\\u0026gt; list[mcp_types.Tool]: \\u0026#34;\\u0026#34;\\u0026#34;Advertise our ADK tool in MCP format.\\u0026#34;\\u0026#34;\\u0026#34; return [adk_to_mcp_tool_type(health_tool)] @app.call_tool() async def call_tool(name: str, arguments: dict) -\\u0026gt; list[mcp_types.TextContent]: \\u0026#34;\\u0026#34;\\u0026#34;Route incoming MCP tool calls to the ADK tool.\\u0026#34;\\u0026#34;\\u0026#34; if name == health_tool.name: result = await health_tool.run_async(args=arguments, tool_context=None) return [mcp_types.TextContent(type=\\u0026#34;text\\u0026#34;, text=json.dumps(result, indent=2))] return [mcp_types.TextContent( type=\\u0026#34;text\\u0026#34;, text=json.dumps({\\u0026#34;error\\u0026#34;: f\\u0026#34;Unknown tool: {name}\\u0026#34;}) )] async def run_server(): async with mcp.server.stdio.stdio_server() as (reader, writer): await app.run( reader, writer, InitializationOptions( server_name=app.name, server_version=\\u0026#34;0.1.0\\u0026#34;, capabilities=app.get_capabilities( notification_options=NotificationOptions(), experimental_capabilities={}, ), ), ) if __name__ == \\u0026#34;__main__\\u0026#34;: asyncio.run(run_server()) The adk_to_mcp_tool_type(health_tool) call reads the function signature, docstring, and type hints from the ADK FunctionTool and converts them into the MCP Tool schema that clients expect. The call_tool handler receives calls from any MCP client, executes the underlying ADK tool, and returns the result in MCP format.\\nNote that tool_context is None when running outside of a full ADK Runner invocation. If your tool relies on features from ToolContext, such as session state or artifacts, you will need additional handling to provide that context.\\nTesting with an ADK agent Now we can test this server by connecting an ADK agent to it as a client. The agent treats our custom MCP server exactly like any other MCP server.\\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 # agent.py import os from google.adk.agents import LlmAgent from google.adk.tools.mcp_tool import McpToolset from google.adk.tools.mcp_tool.mcp_session_manager import StdioConnectionParams from mcp import StdioServerParameters # Get path relative to this agent.py file _AGENT_DIR = os.path.dirname(os.path.abspath(__file__)) MCP_SERVER_PATH = os.path.join(_AGENT_DIR, \\u0026#34;health_check_mcp_server.py\\u0026#34;) root_agent = LlmAgent( model=\\u0026#34;gemini-2.0-flash\\u0026#34;, name=\\u0026#34;ops_assistant\\u0026#34;, instruction=\\u0026#34;You are an operations assistant. Check the health of services when asked.\\u0026#34;, tools=[ McpToolset( connection_params=StdioConnectionParams( server_params=StdioServerParameters( command=\\u0026#34;python\\u0026#34;, args=[MCP_SERVER_PATH], ), timeout=60, ), ) ], ) When this agent runs and a user asks \\u0026ldquo;How is the payments service doing?\\u0026rdquo;, the LLM will invoke the check_service_health tool through the MCP protocol, and the server will execute the ADK tool function and return the health data.\\n1 2 3 4 5 \\u0026gt; adk run .\\\\mcp_agent\\\\ Running agent ops_assistant, type exit to exit. [user]: How is the payments service doing? [ops_assistant]: The payments service is healthy with a latency of 45ms and uptime of 99.97%. Using FastMCP for simpler server creation For quick server development, you can use FastMCP, which ADK leverages internally. With FastMCP, you decorate your tool functions directly and skip the boilerplate of manually implementing list_tools and call_tool handlers.\\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 # fast_mcp_server.py from mcp.server.fastmcp import FastMCP mcp = FastMCP(\\u0026#34;weather-service\\u0026#34;) @mcp.tool() def get_current_temperature(city: str) -\\u0026gt; str: \\u0026#34;\\u0026#34;\\u0026#34;Gets the current temperature for a given city.\\u0026#34;\\u0026#34;\\u0026#34; # Simulated data temps = {\\u0026#34;london\\u0026#34;: \\u0026#34;14°C\\u0026#34;, \\u0026#34;tokyo\\u0026#34;: \\u0026#34;22°C\\u0026#34;, \\u0026#34;new york\\u0026#34;: \\u0026#34;18°C\\u0026#34;, \\u0026#34;mumbai\\u0026#34;: \\u0026#34;32°C\\u0026#34;} return temps.get(city.lower(), f\\u0026#34;No data available for {city}\\u0026#34;) @mcp.tool() def get_weather_forecast(city: str, days: int = 3) -\\u0026gt; str: \\u0026#34;\\u0026#34;\\u0026#34;Gets a weather forecast for a city for the specified number of days.\\u0026#34;\\u0026#34;\\u0026#34; return f\\u0026#34;Forecast for {city} over {days} days: Mostly sunny with occasional clouds.\\u0026#34; if __name__ == \\u0026#34;__main__\\u0026#34;: mcp.run(transport=\\u0026#34;stdio\\u0026#34;) This FastMCP server can be consumed by any ADK agent using StdioConnectionParams pointing to python3 fast_mcp_server.py. For remote deployment, you can switch the transport to Streamable HTTP and run the server behind an ASGI server such as Uvicorn.\\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 # remote_fast_mcp_server.py import uvicorn from mcp.server.fastmcp import FastMCP mcp = FastMCP(\\u0026#34;weather-service\\u0026#34;) @mcp.tool() def get_current_temperature(city: str) -\\u0026gt; str: \\u0026#34;\\u0026#34;\\u0026#34;Gets the current temperature for a given city.\\u0026#34;\\u0026#34;\\u0026#34; # Simulated data temps = {\\u0026#34;london\\u0026#34;: \\u0026#34;14°C\\u0026#34;, \\u0026#34;tokyo\\u0026#34;: \\u0026#34;22°C\\u0026#34;, \\u0026#34;new york\\u0026#34;: \\u0026#34;18°C\\u0026#34;, \\u0026#34;mumbai\\u0026#34;: \\u0026#34;32°C\\u0026#34;} return temps.get(city.lower(), f\\u0026#34;No data available for {city}\\u0026#34;) @mcp.tool() def get_weather_forecast(city: str, days: int = 3) -\\u0026gt; str: \\u0026#34;\\u0026#34;\\u0026#34;Gets a weather forecast for a city for the specified number of days.\\u0026#34;\\u0026#34;\\u0026#34; return f\\u0026#34;Forecast for {city} over {days} days: Mostly sunny with occasional clouds.\\u0026#34; app = mcp.streamable_http_app() if __name__ == \\u0026#34;__main__\\u0026#34;: uvicorn.run(app, host=\\u0026#34;0.0.0.0\\u0026#34;, port=3000) An ADK agent then connects using StreamableHTTPConnectionParams.\\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 from google.adk.agents import LlmAgent from google.adk.tools.mcp_tool import MCPToolset, StreamableHTTPConnectionParams root_agent = LlmAgent( model=\\u0026#34;gemini-2.0-flash\\u0026#34;, name=\\u0026#34;weather_agent\\u0026#34;, instruction=\\u0026#34;Provide weather information when asked.\\u0026#34;, tools=[ MCPToolset( connection_params=StreamableHTTPConnectionParams( url=\\u0026#34;http://localhost:3000/mcp\\u0026#34;, ), ) ], ) 1 2 3 4 5 6 7 8 9 10 \\u0026gt; adk run .\\\\mcp_agent\\\\ Running agent weather_agent, type exit to exit. [user]: how is weather in Bengaluru? [weather_agent]: I am sorry, I cannot fulfill this request. I do not have the weather information for Bengaluru. [user]: how is weather in london? [weather_agent]: The current temperature in London is 14°C. Key considerations There are several important points to keep in mind when working with MCP tools in ADK.\\nStatefulness MCP establishes stateful, persistent connections between client and server. This is different from typical stateless REST APIs and has implications for scaling and deployment. When deploying remote MCP servers, you need to think about session affinity, load balancing, and connection pooling. The McpToolset manages this connection lifecycle for you within the agent process.\\nAsync nature Both ADK and the MCP Python library are built on Python\\u0026rsquo;s asyncio. Tool implementations and server handlers should generally be async functions. The McpToolset handles the async communication transparently, but if you are building custom MCP servers, your tool handlers should follow async patterns.\\nDeployment considerations When deploying ADK agents with MCP tools to production environments like Cloud Run or Vertex AI Agent Engine, the agent and McpToolset must be defined synchronously in your agent.py file. While adk web allows for asynchronous agent creation, deployment environments require synchronous instantiation.\\nFor Stdio-based MCP servers, the server binary or script must be included in the deployment container since the agent spawns it as a subprocess. For remote servers using SSE or Streamable HTTP, you deploy the MCP server independently and configure your agent with the server\\u0026rsquo;s URL.\\nA production deployment checklist for agents using MCP tools includes:\\nEnsuring MCP server binaries are bundled in the container image for Stdio transports Configuring health checks for remote MCP server connections Setting appropriate timeouts on SseConnectionParams or StreamableHTTPConnectionParams Implementing authentication headers for remote servers, and monitoring connection stability. Pre-built MCP tools ADK offers a growing catalog of pre-built MCP tool integrations for popular services. These include integrations with Atlassian (Jira and Confluence), Google Cloud services via the API Registry, and generative media services such as Imagen and Veo. You can find the full list in the ADK documentation under Tools and Integrations. Using a prebuilt integration is as simple as adding the appropriate McpToolset with the correct connection parameters, as we demonstrated earlier with the filesystem and Google Maps examples.\\nPutting it all together Here is a complete example that combines consuming an MCP server with tool filtering and session state tracking. The agent uses a local filesystem MCP server to read project notes, while also maintaining conversation context through ADK\\u0026rsquo;s session state.\\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 import asyncio import os from google.adk.agents import LlmAgent from google.adk.sessions import InMemorySessionService from google.adk.runners import Runner from google.adk.tools import ToolContext from google.adk.tools.mcp_tool import McpToolset from google.adk.tools.mcp_tool.mcp_session_manager import StdioConnectionParams from mcp import StdioServerParameters from google.genai.types import Content, Part def summarize_findings(summary: str, tool_context: ToolContext) -\\u0026gt; dict: \\u0026#34;\\u0026#34;\\u0026#34;Records a summary of findings from the file research.\\u0026#34;\\u0026#34;\\u0026#34; summaries = tool_context.state.get(\\u0026#34;research_summaries\\u0026#34;, []) summaries.append(summary) tool_context.state[\\u0026#34;research_summaries\\u0026#34;] = summaries tool_context.state[\\u0026#34;total_summaries\\u0026#34;] = len(summaries) return {\\u0026#34;status\\u0026#34;: \\u0026#34;recorded\\u0026#34;, \\u0026#34;total_summaries\\u0026#34;: len(summaries)} NOTES_DIR = os.path.expanduser(\\u0026#34;~/project-notes\\u0026#34;) research_agent = LlmAgent( model=\\u0026#34;gemini-2.0-flash\\u0026#34;, name=\\u0026#34;ResearchAgent\\u0026#34;, instruction=\\u0026#34;\\u0026#34;\\u0026#34;You are a research assistant. Use file tools to read notes from the project directory. After reading relevant files, use the summarize_findings tool to record your analysis. Total summaries recorded so far: {total_summaries?}\\u0026#34;\\u0026#34;\\u0026#34;, tools=[ McpToolset( connection_params=StdioConnectionParams( server_params=StdioServerParameters( command=\\u0026#34;npx\\u0026#34;, args=[ \\u0026#34;-y\\u0026#34;, \\u0026#34;@modelcontextprotocol/server-filesystem\\u0026#34;, os.path.abspath(NOTES_DIR), ], ), ), tool_filter=[\\u0026#34;read_file\\u0026#34;, \\u0026#34;list_directory\\u0026#34;, \\u0026#34;search_files\\u0026#34;], ), summarize_findings, ], output_key=\\u0026#34;last_response\\u0026#34;, ) async def main(): session_service = InMemorySessionService() runner = Runner( agent=research_agent, app_name=\\u0026#34;research_app\\u0026#34;, session_service=session_service, ) session = await session_service.create_session( app_name=\\u0026#34;research_app\\u0026#34;, user_id=\\u0026#34;researcher_1\\u0026#34;, state={\\u0026#34;total_summaries\\u0026#34;: 0}, ) # Turn 1: Explore available files msg1 = Content( parts=[Part(text=\\u0026#34;What project notes do we have available?\\u0026#34;)], role=\\u0026#34;user\\u0026#34;, ) async for event in runner.run_async( user_id=\\u0026#34;researcher_1\\u0026#34;, session_id=session.id, new_message=msg1 ): if event.is_final_response() and event.content: print(f\\u0026#34;Agent: {event.content.parts[0].text}\\u0026#34;) # Turn 2: Read and summarize a specific file msg2 = Content( parts=[Part(text=\\u0026#34;Read the architecture.md file and summarize the key decisions.\\u0026#34;)], role=\\u0026#34;user\\u0026#34;, ) async for event in runner.run_async( user_id=\\u0026#34;researcher_1\\u0026#34;, session_id=session.id, new_message=msg2 ): if event.is_final_response() and event.content: print(f\\u0026#34;Agent: {event.content.parts[0].text}\\u0026#34;) # Check state s = await session_service.get_session( app_name=\\u0026#34;research_app\\u0026#34;, user_id=\\u0026#34;researcher_1\\u0026#34;, session_id=session.id ) print(f\\u0026#34;State: total_summaries={s.state.get(\\u0026#39;total_summaries\\u0026#39;)}\\u0026#34;) print(f\\u0026#34;State: research_summaries={s.state.get(\\u0026#39;research_summaries\\u0026#39;)}\\u0026#34;) asyncio.run(main()) This example demonstrates a common pattern in real applications:\\nCombining external tools from an MCP server with custom ADK tools that maintain state. The filesystem tools handle file operations The summarize_findings function records analysis in the session state using ToolContext The agent\\u0026rsquo;s instruction template dynamically reflects the current summary count. Understanding how to consume and expose MCP tools with ADK opens up a broad ecosystem of reusable capabilities for your agents. The McpToolset class makes it straightforward to connect to any MCP-compliant server, regardless of the transport mechanism, while ADK\\u0026rsquo;s conversion utilities let you share your tools with the wider MCP ecosystem. I recommend starting with a community MCP server, such as the Filesystem or GitHub examples, to get comfortable with the pattern, then build your own servers for custom capabilities.\\n\"",
  "url": "https:\/\/ravichaganti.com\/blog\/google-adk-mcp-tools\/",
  "datePublished": "2025-12-20T00:00:00Z",
  "dateModified": "2025-12-20T00:00:00Z",
  "author": {
    "@type": "Person",
    "name": "Ravikanth Chaganti"
    ,"sameAs": ["https://twitter.com/ravikanth"]
  },
  "publisher": {
    "@type": "Person",
    "name": "Ravikanth Chaganti",
    "sameAs": ["https://twitter.com/ravikanth"]
  },
  
  "image": {
    "@type": "ImageObject",
    "url": "https:\/\/ravichaganti.com\/images\/adk.png",
    "width": 1200,
    "height": 630
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https:\/\/ravichaganti.com\/blog\/google-adk-mcp-tools\/"
  },
  
  "articleSection": "\"Google\"",
  
  
  
  "timeRequired": "PT18M",
  
  "inLanguage": "en-US",
  "isAccessibleForFree": true
}
</script>




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https:\/\/ravichaganti.com\/"
    }
    ,
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Blog",
      "item": "https:\/\/ravichaganti.com\/blog/"
    }
    
    ,
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Google",
      "item": "https:\/\/ravichaganti.com\/categories/google/"
    },
    {
      "@type": "ListItem",
      "position": 4,
      "name": "Google ADK - MCP tools",
      "item": "https:\/\/ravichaganti.com\/blog\/google-adk-mcp-tools\/"
    }
    
    
  ]
}
</script>


</head>

<body class="flex flex-col min-h-screen bg-gray-50 dark:bg-dark-bg">
  <header class="sticky top-0 z-50 bg-white dark:bg-dark-bg-secondary shadow-md relative">
  <nav class="container mx-auto px-4 py-4">
    <div class="flex items-center justify-between">
      
      <div class="flex items-center">
        <a href="https://ravichaganti.com/" class="flex items-center gap-3 text-gray-900 dark:text-dark-text hover:text-primary transition-colors no-underline group">
          
          <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-shrink-0">
            <circle cx="20" cy="20" r="18" stroke="currentColor" stroke-width="2" class="group-hover:stroke-primary transition-colors"/>
            <text x="20" y="26" font-family="sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="currentColor">RC</text>
          </svg>
          
          <div class="flex flex-col leading-tight">
            <span class="text-xs sm:text-sm font-semibold">Cloud Native</span>
            <span class="text-xs sm:text-sm font-semibold">Agentic AI</span>
            <span class="text-xs sm:text-sm font-semibold">Infrastructure</span>
          </div>
        </a>
      </div>

      
      <div class="hidden md:flex items-center space-x-8">
        
          <a href="/blog/" class="text-gray-700 dark:text-dark-text-secondary hover:text-primary font-medium transition-all no-underline hover:underline hover:decoration-blue-500 hover:decoration-2 hover:underline-offset-4">
            Blog
          </a>
        
          <a href="/books/" class="text-gray-700 dark:text-dark-text-secondary hover:text-primary font-medium transition-all no-underline hover:underline hover:decoration-blue-500 hover:decoration-2 hover:underline-offset-4">
            Books
          </a>
        
          <a href="https://learn.ravichaganti.com" target="_blank" rel="noopener noreferrer" class="text-gray-700 dark:text-dark-text-secondary hover:text-primary font-medium transition-all no-underline hover:underline hover:decoration-blue-500 hover:decoration-2 hover:underline-offset-4">
            Courses
          </a>
        
          <a href="https://www.linkedin.com/build-relation/newsletter-follow?entityUrn=7418529089365520384" target="_blank" rel="noopener noreferrer" class="text-gray-700 dark:text-dark-text-secondary hover:text-primary font-medium transition-all no-underline hover:underline hover:decoration-blue-500 hover:decoration-2 hover:underline-offset-4">
            Newsletter
          </a>
        
          <a href="/about/" class="text-gray-700 dark:text-dark-text-secondary hover:text-primary font-medium transition-all no-underline hover:underline hover:decoration-blue-500 hover:decoration-2 hover:underline-offset-4">
            About
          </a>
        
      </div>

      
      <div class="hidden md:flex items-center space-x-4 relative" id="social-search-container">
        
        <div id="social-icons" class="flex items-center space-x-3">
          

<a href="https://twitter.com/ravikanth" target="_blank" rel="noopener noreferrer" class="p-2 hover:bg-gray-100 dark:hover:bg-dark-bg-tertiary rounded-full transition-colors" aria-label="Twitter">
  <svg class="w-5 h-5 text-gray-700 dark:text-dark-text hover:text-primary dark:hover:text-blue-400" fill="currentColor" viewBox="0 0 24 24">
    <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
  </svg>
</a>



<a href="https://github.com/rchaganti" target="_blank" rel="noopener noreferrer" class="p-2 hover:bg-gray-100 dark:hover:bg-dark-bg-tertiary rounded-full transition-colors" aria-label="GitHub">
  <svg class="w-5 h-5 text-gray-700 dark:text-dark-text hover:text-primary dark:hover:text-blue-400" fill="currentColor" viewBox="0 0 24 24">
    <path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"/>
  </svg>
</a>



<a href="https://linkedin.com/in/rchaganti" target="_blank" rel="noopener noreferrer" class="p-2 hover:bg-gray-100 dark:hover:bg-dark-bg-tertiary rounded-full transition-colors" aria-label="LinkedIn">
  <svg class="w-5 h-5 text-gray-700 dark:text-dark-text hover:text-primary dark:hover:text-blue-400" fill="currentColor" viewBox="0 0 24 24">
    <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
  </svg>
</a>




        </div>

        
        <button
          id="theme-toggle"
          class="p-2 hover:bg-gray-100 dark:hover:bg-dark-bg-tertiary rounded-full transition-colors"
          aria-label="Toggle dark mode"
          title="Toggle dark mode"
        >
          
          <svg class="theme-icon-sun w-5 h-5 text-gray-700 dark:text-dark-text hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
          </svg>

          
          <svg class="theme-icon-moon w-5 h-5 text-gray-700 dark:text-dark-text" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
          </svg>
        </button>

        
        <button id="search-toggle" class="p-2 hover:bg-gray-100 dark:hover:bg-dark-bg-tertiary rounded-full transition-colors" aria-label="Search">
          <svg class="w-5 h-5 text-gray-700 dark:text-dark-text" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
        </button>

        
        <div id="search-box" class="hidden absolute top-full right-0 mt-2 w-80 bg-white dark:bg-dark-bg-secondary shadow-lg p-4 z-50 rounded-lg">
          





<div class="relative search-container" data-mode="desktop">
  <input
    type="text"
    id="search-input-desktop"
    placeholder="Search articles..."
    class="search-input w-full px-4 py-2 text-sm border border-gray-300 dark:border-dark-border bg-white dark:bg-dark-bg-secondary text-gray-900 dark:text-dark-text rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
    aria-label="Search"
    autocomplete="off"
  >
  <div id="search-results-desktop" class="search-results absolute top-full mt-2 w-full bg-white dark:bg-dark-bg-secondary border border-gray-200 dark:border-dark-border rounded-lg shadow-xl hidden max-h-80 overflow-y-auto z-50">
    
  </div>
</div>



<script src="https://cdn.jsdelivr.net/npm/fuse.js@7.0.0"></script>


<script>
(function() {
  let headerFuse;
  let headerSearchData = [];
  let searchInitialized = false;

  
  fetch('/index.json')
    .then(response => response.json())
    .then(data => {
      headerSearchData = data;

      
      const options = {
        keys: [
          { name: 'title', weight: 3 },
          { name: 'excerpt', weight: 2 },
          { name: 'content', weight: 1 },
          { name: 'categories', weight: 1.5 },
          { name: 'series', weight: 1.5 }
        ],
        threshold: 0.4,
        includeScore: true,
        ignoreLocation: true,
        minMatchCharLength: 2
      };

      headerFuse = new Fuse(headerSearchData, options);
      searchInitialized = true;
    })
    .catch(error => console.error('Error loading search index:', error));

  
  function renderResults(results, resultsContainer) {
    if (results.length === 0) {
      resultsContainer.innerHTML = '<div class="p-4 text-center text-gray-500 dark:text-dark-text-secondary text-sm">No results found</div>';
      resultsContainer.classList.remove('hidden');
      return;
    }

    resultsContainer.innerHTML = results.slice(0, 5).map(result => {
      const item = result.item;
      const date = new Date(item.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });

      return `
        <a href="${item.permalink}" class="block p-3 hover:bg-gray-50 dark:hover:bg-dark-bg-tertiary border-b border-gray-100 dark:border-dark-border last:border-b-0 no-underline">
          <div class="font-medium text-sm text-gray-900 dark:text-dark-text mb-1">${item.title}</div>
          <div class="flex items-center gap-2 mb-1 flex-wrap">
            <span class="text-xs text-gray-500 dark:text-dark-text-secondary">${date}</span>
            ${item.categories ? item.categories.slice(0, 2).map(cat => `
              <span class="inline-block px-1.5 py-0.5 text-xs rounded bg-primary/10 dark:bg-primary/20 text-primary dark:text-blue-400">
                ${cat}
              </span>
            `).join('') : ''}
          </div>
          ${item.excerpt ? `<p class="text-xs text-gray-600 dark:text-dark-text-secondary line-clamp-2">${item.excerpt}</p>` : ''}
        </a>
      `;
    }).join('');

    resultsContainer.classList.remove('hidden');
  }

  
  function initSearchContainers() {
    const containers = document.querySelectorAll('.search-container');

    containers.forEach(container => {
      const searchInput = container.querySelector('.search-input');
      const searchResults = container.querySelector('.search-results');

      if (!searchInput || !searchResults) return;

      
      searchInput.addEventListener('input', function(e) {
        const query = e.target.value.trim();

        if (query.length < 2 || !searchInitialized) {
          searchResults.classList.add('hidden');
          return;
        }

        const results = headerFuse.search(query);
        renderResults(results, searchResults);
      });

      
      searchInput.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
          searchResults.classList.add('hidden');
          searchInput.blur();
        }
      });
    });

    
    function closeAllResults(e) {
      const containers = document.querySelectorAll('.search-container');
      containers.forEach(container => {
        const searchResults = container.querySelector('.search-results');
        if (searchResults && !container.contains(e.target)) {
          searchResults.classList.add('hidden');
        }
      });
    }

    document.addEventListener('click', closeAllResults);
    document.addEventListener('touchend', closeAllResults);
  }

  
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initSearchContainers);
  } else {
    initSearchContainers();
  }
})();
</script>


        </div>
      </div>

      
      <div class="md:hidden flex items-center gap-2">
        
        <button id="search-toggle-mobile" class="p-2 hover:bg-gray-100 dark:hover:bg-dark-bg-tertiary rounded-full transition-colors" aria-label="Search">
          <svg class="w-5 h-5 text-gray-700 dark:text-dark-text" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
        </button>

        
        <button
          id="theme-toggle-mobile"
          class="p-2 hover:bg-gray-100 dark:hover:bg-dark-bg-tertiary rounded-full transition-colors"
          aria-label="Toggle dark mode"
          title="Toggle dark mode"
        >
          
          <svg class="theme-icon-sun w-5 h-5 text-gray-700 dark:text-dark-text hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
          </svg>

          
          <svg class="theme-icon-moon w-5 h-5 text-gray-700 dark:text-dark-text" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
          </svg>
        </button>

        
        <button id="mobile-menu-toggle" class="p-2 hover:bg-gray-100 dark:hover:bg-dark-bg-tertiary rounded" aria-label="Menu">
          <svg class="w-6 h-6 text-gray-700 dark:text-dark-text" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>
    </div>

    
    <div id="search-box-mobile" class="hidden md:hidden absolute top-full left-0 right-0 bg-white dark:bg-dark-bg-secondary shadow-lg p-4 z-50">
      





<div class="relative search-container" data-mode="mobile">
  <input
    type="text"
    id="search-input-mobile"
    placeholder="Search articles..."
    class="search-input w-full px-4 py-2 text-sm border border-gray-300 dark:border-dark-border bg-white dark:bg-dark-bg-secondary text-gray-900 dark:text-dark-text rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
    aria-label="Search"
    autocomplete="off"
  >
  <div id="search-results-mobile" class="search-results absolute top-full mt-2 w-full bg-white dark:bg-dark-bg-secondary border border-gray-200 dark:border-dark-border rounded-lg shadow-xl hidden max-h-80 overflow-y-auto z-50">
    
  </div>
</div>




    </div>

    
    <div id="mobile-menu" class="hidden md:hidden mt-4 pb-4">
      
        <a href="/blog/" class="block py-3 px-2 text-base text-gray-700 dark:text-dark-text-secondary hover:text-primary hover:bg-gray-100 dark:hover:bg-dark-bg-tertiary transition-colors no-underline rounded-md min-h-[44px] flex items-center">
          Blog
        </a>
      
        <a href="/books/" class="block py-3 px-2 text-base text-gray-700 dark:text-dark-text-secondary hover:text-primary hover:bg-gray-100 dark:hover:bg-dark-bg-tertiary transition-colors no-underline rounded-md min-h-[44px] flex items-center">
          Books
        </a>
      
        <a href="https://learn.ravichaganti.com" target="_blank" rel="noopener noreferrer" class="block py-3 px-2 text-base text-gray-700 dark:text-dark-text-secondary hover:text-primary hover:bg-gray-100 dark:hover:bg-dark-bg-tertiary transition-colors no-underline rounded-md min-h-[44px] flex items-center">
          Courses
        </a>
      
        <a href="https://www.linkedin.com/build-relation/newsletter-follow?entityUrn=7418529089365520384" target="_blank" rel="noopener noreferrer" class="block py-3 px-2 text-base text-gray-700 dark:text-dark-text-secondary hover:text-primary hover:bg-gray-100 dark:hover:bg-dark-bg-tertiary transition-colors no-underline rounded-md min-h-[44px] flex items-center">
          Newsletter
        </a>
      
        <a href="/about/" class="block py-3 px-2 text-base text-gray-700 dark:text-dark-text-secondary hover:text-primary hover:bg-gray-100 dark:hover:bg-dark-bg-tertiary transition-colors no-underline rounded-md min-h-[44px] flex items-center">
          About
        </a>
      
    </div>
  </nav>

  
  
    <div id="reading-progress" class="absolute bottom-0 left-0 w-full h-1 bg-primary transition-all duration-200 z-10" style="width: 0%; max-width: 100%;"></div>
  
</header>


<script>
  document.getElementById('mobile-menu-toggle')?.addEventListener('click', function() {
    const menu = document.getElementById('mobile-menu');
    menu?.classList.toggle('hidden');
  });

  
  document.getElementById('search-toggle')?.addEventListener('click', function() {
    const searchBox = document.getElementById('search-box');
    searchBox?.classList.toggle('hidden');
    if (!searchBox?.classList.contains('hidden')) {
      searchBox?.querySelector('.search-input')?.focus();
    }
  });

  
  document.getElementById('search-toggle-mobile')?.addEventListener('click', function() {
    const searchBoxMobile = document.getElementById('search-box-mobile');
    searchBoxMobile?.classList.toggle('hidden');
    if (!searchBoxMobile?.classList.contains('hidden')) {
      searchBoxMobile?.querySelector('.search-input')?.focus();
    }
  });

  
  document.addEventListener('click', function(e) {
    const searchBox = document.getElementById('search-box');
    const searchToggle = document.getElementById('search-toggle');
    if (searchBox && searchToggle && !searchBox.contains(e.target) && !searchToggle.contains(e.target)) {
      searchBox.classList.add('hidden');
    }
  });

  
  document.addEventListener('click', function(e) {
    const searchBoxMobile = document.getElementById('search-box-mobile');
    const searchToggleMobile = document.getElementById('search-toggle-mobile');
    if (searchBoxMobile && searchToggleMobile && !searchBoxMobile.contains(e.target) && !searchToggleMobile.contains(e.target)) {
      searchBoxMobile.classList.add('hidden');
    }
  });
</script>


  <main class="flex-grow">
    
<article class="container mx-auto px-4 sm:px-6 md:px-4 py-8 sm:py-10 md:py-12">
  <div class="max-w-7xl mx-auto">
    <div class="grid grid-cols-1 lg:grid-cols-[75%_25%] gap-8">
      
      <div class="min-w-0">
        
        <header class="mb-8">
          
          <nav class="text-xs sm:text-sm mb-4">
            <ol class="flex items-center space-x-2 text-gray-600 dark:text-dark-text-secondary">
              <li><a href="https://ravichaganti.com/" class="hover:text-primary dark:hover:text-blue-400">Home</a></li>
              <li><span class="mx-2">/</span></li>
              <li><a href="/blog/" class="hover:text-primary dark:hover:text-blue-400">Blog</a></li>
              
              <li><span class="mx-2">/</span></li>
              <li><a href="/categories/google/" class="hover:text-primary dark:hover:text-blue-400">Google</a></li>
              
            </ol>
          </nav>

          
          <h1 class="text-2xl sm:text-3xl md:text-4xl font-bold text-gray-900 dark:text-dark-text mb-6">
            Google ADK - MCP tools
          </h1>

          
          <div
            class="flex flex-wrap items-center gap-2 sm:gap-3 md:gap-4 text-sm sm:text-base text-gray-600 dark:text-dark-text-secondary mb-6">
            
            <div class="flex items-center">
              <svg class="w-4 h-4 sm:w-5 sm:h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
              </svg>
              <time datetime=" 2025-12-20">December 20, 2025</time>
            </div>

            
            
            <span>•</span>
            <div class="flex items-center">
              <svg class="w-4 h-4 sm:w-5 sm:h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <span>18 min read</span>
            </div>
            

            
            
          </div>

          
          <div class="flex flex-wrap gap-2 mb-6">
            
            
            <a href="/categories/google/"
              class="inline-block px-3 py-1 text-sm font-medium bg-primary/10 dark:bg-primary/20 text-primary dark:text-blue-400 rounded-full hover:bg-primary/20 dark:hover:bg-primary/30 transition-colors no-underline">
              Google
            </a>
            
            <a href="/categories/agent-development-kit/"
              class="inline-block px-3 py-1 text-sm font-medium bg-primary/10 dark:bg-primary/20 text-primary dark:text-blue-400 rounded-full hover:bg-primary/20 dark:hover:bg-primary/30 transition-colors no-underline">
              Agent Development Kit
            </a>
            
            <a href="/categories/agents/"
              class="inline-block px-3 py-1 text-sm font-medium bg-primary/10 dark:bg-primary/20 text-primary dark:text-blue-400 rounded-full hover:bg-primary/20 dark:hover:bg-primary/30 transition-colors no-underline">
              Agents
            </a>
            
            
            
            
            <a href="/series/google-adk/"
              class="inline-block px-3 py-1 text-sm font-medium bg-secondary/10 dark:bg-secondary/20 text-secondary dark:text-purple-400 rounded-full hover:bg-secondary/20 dark:hover:bg-secondary/30 transition-colors no-underline">
              📚 Series: Google ADK
            </a>
            
            
          </div>

          
          
          <div
            class="text-base sm:text-lg md:text-xl text-gray-700 dark:text-dark-text-secondary italic border-l-4 border-primary dark:border-blue-400 pl-4 sm:pl-6 py-2 mb-6 sm:mb-8 bg-gray-50 dark:bg-dark-bg-tertiary rounded-r">
            An agent that can only use the tools you hard-code into it has a ceiling. The Model Context Protocol (MCP) shatters that ceiling by giving your ADK agents a standardized way to discover and use tools hosted anywhere — local processes, remote servers, or cloud services.
          </div>
          
        </header>

        
        


  
  
  
    <aside class="bg-gradient-to-br from-secondary/5 to-primary/5 dark:from-secondary/10 dark:to-primary/10 rounded-lg shadow-md dark:shadow-2xl dark:shadow-black/20 p-4 mb-6 border border-secondary/20 dark:border-secondary/30">
      
      <button
        class="flex items-center justify-between w-full text-left font-semibold text-base text-gray-900 dark:text-dark-text hover:text-secondary dark:hover:text-purple-400 transition-colors"
        aria-expanded="false"
        aria-controls="series-content"
      >
        <span class="flex items-center">
          <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
          </svg>
          Series: Google ADK
        </span>
        <svg
          id="series-chevron"
          class="w-4 h-4 transform transition-transform -rotate-90"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
        </svg>
      </button>

      
      <p class="text-xs text-gray-600 dark:text-dark-text-secondary mt-2 mb-2 collapsed" id="series-description">
        Part of a 9-part series
      </p>

      
      <nav id="series-content" class="series-content collapsed mt-1">
        <ol class="space-y-3">
          
            <li class="flex items-start">
              <span class="flex-shrink-0 w-6 h-6 rounded-full bg-secondary/20 dark:bg-secondary/30 text-secondary dark:text-purple-400 flex items-center justify-center text-xs font-bold mr-3 mt-0.5">
                1
              </span>
              <div class="flex-grow">
                
                  <a href="https://ravichaganti.com/blog/introduction-to-google-agent-development-kit/" class="text-gray-700 dark:text-dark-text-secondary hover:text-secondary dark:hover:text-purple-400 transition-colors no-underline hover:underline">
                    Introduction to Google Agent Development Kit
                  </a>
                
                <p class="text-xs text-gray-500 dark:text-dark-text-muted mt-1">Dec 1, 2025</p>
              </div>
            </li>
          
            <li class="flex items-start">
              <span class="flex-shrink-0 w-6 h-6 rounded-full bg-secondary/20 dark:bg-secondary/30 text-secondary dark:text-purple-400 flex items-center justify-center text-xs font-bold mr-3 mt-0.5">
                2
              </span>
              <div class="flex-grow">
                
                  <a href="https://ravichaganti.com/blog/google-adk-types-of-agents/" class="text-gray-700 dark:text-dark-text-secondary hover:text-secondary dark:hover:text-purple-400 transition-colors no-underline hover:underline">
                    Google ADK - types of agents
                  </a>
                
                <p class="text-xs text-gray-500 dark:text-dark-text-muted mt-1">Dec 3, 2025</p>
              </div>
            </li>
          
            <li class="flex items-start">
              <span class="flex-shrink-0 w-6 h-6 rounded-full bg-secondary/20 dark:bg-secondary/30 text-secondary dark:text-purple-400 flex items-center justify-center text-xs font-bold mr-3 mt-0.5">
                3
              </span>
              <div class="flex-grow">
                
                  <a href="https://ravichaganti.com/blog/google-adk-sessions-state-and-memory/" class="text-gray-700 dark:text-dark-text-secondary hover:text-secondary dark:hover:text-purple-400 transition-colors no-underline hover:underline">
                    Google ADK - Sessions, state, and memory
                  </a>
                
                <p class="text-xs text-gray-500 dark:text-dark-text-muted mt-1">Dec 5, 2025</p>
              </div>
            </li>
          
            <li class="flex items-start">
              <span class="flex-shrink-0 w-6 h-6 rounded-full bg-secondary/20 dark:bg-secondary/30 text-secondary dark:text-purple-400 flex items-center justify-center text-xs font-bold mr-3 mt-0.5">
                4
              </span>
              <div class="flex-grow">
                
                  <a href="https://ravichaganti.com/blog/google-adk-callbacks/" class="text-gray-700 dark:text-dark-text-secondary hover:text-secondary dark:hover:text-purple-400 transition-colors no-underline hover:underline">
                    Google ADK - Callbacks
                  </a>
                
                <p class="text-xs text-gray-500 dark:text-dark-text-muted mt-1">Dec 12, 2025</p>
              </div>
            </li>
          
            <li class="flex items-start">
              <span class="flex-shrink-0 w-6 h-6 rounded-full bg-secondary/20 dark:bg-secondary/30 text-secondary dark:text-purple-400 flex items-center justify-center text-xs font-bold mr-3 mt-0.5">
                5
              </span>
              <div class="flex-grow">
                
                  <a href="https://ravichaganti.com/blog/google-adk-runner-and-execution-architecture/" class="text-gray-700 dark:text-dark-text-secondary hover:text-secondary dark:hover:text-purple-400 transition-colors no-underline hover:underline">
                    Google ADK - Runner and execution architecture
                  </a>
                
                <p class="text-xs text-gray-500 dark:text-dark-text-muted mt-1">Dec 18, 2025</p>
              </div>
            </li>
          
            <li class="flex items-start">
              <span class="flex-shrink-0 w-6 h-6 rounded-full bg-secondary/20 dark:bg-secondary/30 text-secondary dark:text-purple-400 flex items-center justify-center text-xs font-bold mr-3 mt-0.5">
                6
              </span>
              <div class="flex-grow">
                
                  <span class="font-bold text-secondary dark:text-purple-400">
                    Google ADK - MCP tools
                    <span class="text-xs ml-2 px-2 py-0.5 bg-secondary dark:bg-purple-600 text-white rounded">You are here</span>
                  </span>
                
                <p class="text-xs text-gray-500 dark:text-dark-text-muted mt-1">Dec 20, 2025</p>
              </div>
            </li>
          
            <li class="flex items-start">
              <span class="flex-shrink-0 w-6 h-6 rounded-full bg-secondary/20 dark:bg-secondary/30 text-secondary dark:text-purple-400 flex items-center justify-center text-xs font-bold mr-3 mt-0.5">
                7
              </span>
              <div class="flex-grow">
                
                  <a href="https://ravichaganti.com/blog/google-adk-openapi-tools-agents-as-tools-authentication-and-long-running-operations/" class="text-gray-700 dark:text-dark-text-secondary hover:text-secondary dark:hover:text-purple-400 transition-colors no-underline hover:underline">
                    Google ADK - OpenAPI tools, agents-as-tools, authentication, and long-running operations
                  </a>
                
                <p class="text-xs text-gray-500 dark:text-dark-text-muted mt-1">Dec 23, 2025</p>
              </div>
            </li>
          
            <li class="flex items-start">
              <span class="flex-shrink-0 w-6 h-6 rounded-full bg-secondary/20 dark:bg-secondary/30 text-secondary dark:text-purple-400 flex items-center justify-center text-xs font-bold mr-3 mt-0.5">
                8
              </span>
              <div class="flex-grow">
                
                  <a href="https://ravichaganti.com/blog/building-a-multi-agent-linkedin-newsletter-system-with-google-adk/" class="text-gray-700 dark:text-dark-text-secondary hover:text-secondary dark:hover:text-purple-400 transition-colors no-underline hover:underline">
                    Building a Multi-Agent LinkedIn Newsletter System with Google ADK
                  </a>
                
                <p class="text-xs text-gray-500 dark:text-dark-text-muted mt-1">Jan 26, 2026</p>
              </div>
            </li>
          
            <li class="flex items-start">
              <span class="flex-shrink-0 w-6 h-6 rounded-full bg-secondary/20 dark:bg-secondary/30 text-secondary dark:text-purple-400 flex items-center justify-center text-xs font-bold mr-3 mt-0.5">
                9
              </span>
              <div class="flex-grow">
                
                  <a href="https://ravichaganti.com/blog/building-multi-agent-systems-with-google-adk-and-the-a2a-protocol/" class="text-gray-700 dark:text-dark-text-secondary hover:text-secondary dark:hover:text-purple-400 transition-colors no-underline hover:underline">
                    Building multi-agent systems with Google ADK and the A2A protocol
                  </a>
                
                <p class="text-xs text-gray-500 dark:text-dark-text-muted mt-1">Jan 27, 2026</p>
              </div>
            </li>
          
        </ol>

        
        <div class="mt-6 pt-6 border-t border-secondary/20 dark:border-secondary/30 grid grid-cols-2 gap-4">
          
          
            
          
            
          
            
          
            
          
            
          
            
              
            
          
            
          
            
          
            
          

          
          
            
            <a href="https://ravichaganti.com/blog/google-adk-runner-and-execution-architecture/" class="flex items-center text-sm text-gray-700 dark:text-dark-text-secondary hover:text-secondary dark:hover:text-purple-400 transition-colors no-underline group">
              <svg class="w-4 h-4 mr-1 group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
              </svg>
              <span class="truncate">Google ADK - Runner and execution architecture</span>
            </a>
          

          
          
            
            <a href="https://ravichaganti.com/blog/google-adk-openapi-tools-agents-as-tools-authentication-and-long-running-operations/" class="flex items-center justify-end text-sm text-gray-700 dark:text-dark-text-secondary hover:text-secondary dark:hover:text-purple-400 transition-colors no-underline group">
              <span class="truncate">Google ADK - OpenAPI tools, agents-as-tools, authentication, and long-running operations</span>
              <svg class="w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
              </svg>
            </a>
          
        </div>
      </nav>
    </aside>
  



        
        <div class="block lg:hidden mobile-toc-container">
          

  
    <div class="bg-white dark:bg-dark-bg-secondary rounded-lg shadow-md dark:shadow-2xl dark:shadow-black/20 p-4 mb-6 border border-gray-200 dark:border-dark-border">
      
      <button
        class="flex items-center justify-between w-full text-left font-semibold text-base text-gray-900 dark:text-dark-text hover:text-primary dark:hover:text-blue-400 transition-colors"
        aria-expanded="false"
        aria-controls="toc-content"
      >
        <span class="flex items-center">
          <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"></path>
          </svg>
          Table of Contents
        </span>
        <svg
          id="toc-chevron"
          class="w-4 h-4 transform transition-transform -rotate-90"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
        </svg>
      </button>

      
      <nav id="toc-content" class="toc-content collapsed text-sm mt-3">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#what-is-mcp">What is MCP?</a></li>
    <li><a href="#consuming-mcp-servers">Consuming MCP servers</a>
      <ul>
        <li><a href="#mcptoolset">McpToolset</a></li>
        <li><a href="#connecting-via-stdio">Connecting via Stdio</a></li>
        <li><a href="#connecting-via-sse">Connecting via SSE</a></li>
        <li><a href="#connecting-via-streamable-http">Connecting via Streamable HTTP</a></li>
        <li><a href="#filtering-tools">Filtering tools</a></li>
        <li><a href="#using-mcptoolset-outside-adk-web">Using McpToolset outside adk web</a></li>
        <li><a href="#connecting-to-multiple-mcp-servers">Connecting to multiple MCP servers</a></li>
      </ul>
    </li>
    <li><a href="#exposing-adk-tools-as-an-mcp-server">Exposing ADK tools as an MCP server</a>
      <ul>
        <li><a href="#building-the-mcp-server">Building the MCP server</a></li>
        <li><a href="#testing-with-an-adk-agent">Testing with an ADK agent</a></li>
        <li><a href="#using-fastmcp-for-simpler-server-creation">Using FastMCP for simpler server creation</a></li>
      </ul>
    </li>
    <li><a href="#key-considerations">Key considerations</a>
      <ul>
        <li><a href="#statefulness">Statefulness</a></li>
        <li><a href="#async-nature">Async nature</a></li>
        <li><a href="#deployment-considerations">Deployment considerations</a></li>
        <li><a href="#pre-built-mcp-tools">Pre-built MCP tools</a></li>
      </ul>
    </li>
    <li><a href="#putting-it-all-together">Putting it all together</a></li>
  </ul>
</nav>
      </nav>
    </div>

    <style>
      #toc-content ul {
        list-style: none;
        padding-left: 1rem;
        margin-top: 0.5rem;
        margin-bottom: 0.5rem;
      }
      #toc-content > nav > ul {
        padding-left: 0;
      }
      #toc-content li {
        margin-top: 0.5rem;
        margin-bottom: 0.5rem;
      }
      #toc-content a {
        color: #374151;
        text-decoration: none;
        transition: color 0.2s;
      }
      #toc-content a:hover {
        color: #1e40af;
        text-decoration: underline;
      }
       
      .dark #toc-content a {
        color: #cbd5e1;
      }
      .dark #toc-content a:hover {
        color: #60a5fa;
      }
    </style>
  


        </div>

        <style>
          @media (min-width: 1024px) {
            .mobile-toc-container {
              display: none !important;
            }

             
            html,
            body,
            main,
            article,
            .container,
            .max-w-7xl,
            .grid,
            aside {
              overflow: visible !important;
              height: auto !important;
            }

             
            .sidebar-sticky-reinforced {
              position: -webkit-sticky !important;
              position: sticky !important;
              top: 130px !important;
              z-index: 100;
              align-self: start;
              height: fit-content;
            }
          }
        </style>

        
        <div class="prose prose-sm sm:prose-base md:prose-lg max-w-none mb-8 sm:mb-10 md:mb-12">
          <p>Consider you are building an agent that needs to interact with a company&rsquo;s database, pull data from a third-party API, and read files from a shared drive. Without a standard protocol, you would end up writing custom integration code for each backend. Every new tool means a new adapter. Every new agent that needs the same tool means duplicating that adapter. This approach does not scale. The Model Context Protocol (MCP) solves this by providing a universal standard for how agents connect to external tools and data sources. With MCP, a tool is built once, and any MCP-compatible agent can discover and use it. Google ADK has first-class support for MCP, enabling your agents to both consume tools from MCP servers and expose their own tools as MCP servers.</p>
<h2 id="what-is-mcp">What is MCP?</h2>
<p>MCP is an open standard initiated by Anthropic that defines how LLMs communicate with external applications, data sources, and tools. It follows a client-server architecture. An MCP server exposes capabilities such as data (resources), interaction templates (prompts), and executable functions (tools). An MCP client, which in our case is the ADK agent, connects to the server, discovers what it offers, and uses those capabilities as if they were native.</p>
<p>The key benefit is standardization. Instead of building one-off integrations for every external system, you write an MCP server once, and any MCP client can talk to it. Conversely, your ADK agent, acting as a client, can connect to any MCP server without needing to know the implementation details behind it.</p>
<p>ADK supports two primary integration patterns with MCP.</p>
<ul>
<li><strong>Consuming MCP servers:</strong> Your ADK agent acts as an MCP client, using the tools provided by an external MCP server.</li>
<li><strong>Exposing ADK tools via an MCP server:</strong> You wrap your existing ADK tools inside an MCP server, making them accessible to any MCP-compatible client, not just ADK agents.</li>
</ul>
<h2 id="consuming-mcp-servers">Consuming MCP servers</h2>
<p>This is the most common pattern. You have an existing MCP server, one from the community, a cloud-managed service, or one you built for another application, and you want your ADK agent to use its tools.</p>
<h3 id="mcptoolset">McpToolset</h3>
<p><code>McpToolset</code> is the class at the heart of ADK&rsquo;s MCP integration. When you add an <code>McpToolset</code> instance to your agent&rsquo;s <code>tools</code> list, it handles the entire lifecycle behind the scenes.</p>
<table>
  <thead>
      <tr>
          <th>Responsibility</th>
          <th>What happens</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Connection management</td>
          <td>Establishes and maintains the connection to the MCP server, and tears it down on shutdown</td>
      </tr>
      <tr>
          <td>Tool discovery</td>
          <td>Queries the server for its available tools via the MCP <code>list_tools</code> method</td>
      </tr>
      <tr>
          <td>Schema adaptation</td>
          <td>Converts each discovered MCP tool schema into an ADK-compatible <code>BaseTool</code> instance</td>
      </tr>
      <tr>
          <td>Transparent proxying</td>
          <td>When the LLM invokes a discovered tool, <code>McpToolset</code> forwards the call via the MCP <code>call_tool</code> method</td>
      </tr>
      <tr>
          <td>Filtering</td>
          <td>Selectively exposes only the tools you want, instead of all the tools the server advertises</td>
      </tr>
  </tbody>
</table>
<p>The connection to an MCP server can use one of three transport mechanisms.</p>
<table>
  <thead>
      <tr>
          <th>Transport</th>
          <th>Class</th>
          <th>Use case</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Standard I/O (Stdio)</td>
          <td><code>StdioConnectionParams</code></td>
          <td>The MCP server runs as a local subprocess; communication via stdin/stdout</td>
      </tr>
      <tr>
          <td>Server-Sent Events (SSE)</td>
          <td><code>SseConnectionParams</code></td>
          <td>The MCP server is a remote HTTP service using the legacy SSE transport</td>
      </tr>
      <tr>
          <td>Streamable HTTP</td>
          <td><code>StreamableHTTPConnectionParams</code></td>
          <td>The MCP server is a remote HTTP service using the newer single-endpoint transport</td>
      </tr>
  </tbody>
</table>
<h3 id="connecting-via-stdio">Connecting via Stdio</h3>
<p>Stdio is the simplest transport. The MCP server runs as a child process on the same machine, and ADK communicates with it through standard input and output pipes. Many community MCP servers distributed as Node.js packages use this model.</p>
<p>Here is an example that connects an ADK agent to the community filesystem MCP server. This server provides tools for listing directories, reading files, and performing other file operations.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.agents</span> <span class="kn">import</span> <span class="n">LlmAgent</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.tools.mcp_tool</span> <span class="kn">import</span> <span class="n">McpToolset</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.tools.mcp_tool.mcp_session_manager</span> <span class="kn">import</span> <span class="n">StdioConnectionParams</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">mcp</span> <span class="kn">import</span> <span class="n">StdioServerParameters</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>  
</span></span><span class="line"><span class="cl"><span class="n">load_dotenv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ACCESSIBLE_FOLDER</span> <span class="o">=</span> <span class="s2">&#34;C:/GitHub/google-adk-101&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">root_agent</span> <span class="o">=</span> <span class="n">LlmAgent</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">=</span><span class="s2">&#34;gemini-2.0-flash&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span><span class="o">=</span><span class="s2">&#34;file_assistant&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">instruction</span><span class="o">=</span><span class="sa">f</span><span class="s2">&#34;&#34;&#34;Help the user manage files. You can list directories, read files, and search for content.
</span></span></span><span class="line"><span class="cl"><span class="s2">You have access to the directory: </span><span class="si">{</span><span class="n">ACCESSIBLE_FOLDER</span><span class="si">}</span><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">Always use the full absolute path when calling filesystem tools.
</span></span></span><span class="line"><span class="cl"><span class="s2">Use list_directory first to explore, then read specific files.&#34;&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">tools</span><span class="o">=</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="n">McpToolset</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">connection_params</span><span class="o">=</span><span class="n">StdioConnectionParams</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">server_params</span><span class="o">=</span><span class="n">StdioServerParameters</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                    <span class="n">command</span><span class="o">=</span><span class="s2">&#34;npx.cmd&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">args</span><span class="o">=</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;-y&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;@modelcontextprotocol/server-filesystem&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">ACCESSIBLE_FOLDER</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="n">timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>When this agent starts, <code>McpToolset</code> spawns <code>npx @modelcontextprotocol/server-filesystem</code> as a subprocess, queries it for tools, and makes them available to the LLM. The agent can now respond to prompts such as &ldquo;<em>list all Python files in my project directory</em>&rdquo; or &ldquo;<em>show me the contents of config.yaml</em>&rdquo; without any custom tool code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; adk run .<span class="se">\m</span>cp_agent<span class="se">\
</span></span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Running agent file_assistant, <span class="nb">type</span> <span class="nb">exit</span> to exit.
</span></span><span class="line"><span class="cl"><span class="o">[</span>user<span class="o">]</span>: list files in mcp_agent folder
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>file_assistant<span class="o">]</span>: Okay, I see the following files and directories in the <span class="sb">`</span>mcp_agent<span class="sb">`</span> folder:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">*   <span class="sb">`</span>.adk<span class="sb">`</span> <span class="o">(</span>directory<span class="o">)</span>
</span></span><span class="line"><span class="cl">*   <span class="sb">`</span>agent.py<span class="sb">`</span> <span class="o">(</span>file<span class="o">)</span>
</span></span><span class="line"><span class="cl">*   <span class="sb">`</span>__init__.py<span class="sb">`</span> <span class="o">(</span>file<span class="o">)</span>
</span></span><span class="line"><span class="cl">*   <span class="sb">`</span>__pycache__<span class="sb">`</span> <span class="o">(</span>directory<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Is there anything specific you<span class="err">&#39;</span>d like me to <span class="k">do</span> with these files? For example, I can <span class="nb">read</span> the content of <span class="sb">`</span>agent.py<span class="sb">`</span> or any other file.
</span></span><span class="line"><span class="cl"><span class="o">[</span>user<span class="o">]</span>: 
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="connecting-via-sse">Connecting via SSE</h3>
<p>When the MCP server is running remotely as a standalone HTTP service, you use <code>SseConnectionParams</code>. SSE (Server-Sent Events) was the original network transport for MCP. It uses two separate HTTP endpoints, one for the client to send requests (POST) and another where the client establishes a persistent SSE connection (GET) to receive streaming responses.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.agents</span> <span class="kn">import</span> <span class="n">LlmAgent</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.tools.mcp_tool</span> <span class="kn">import</span> <span class="n">McpToolset</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.tools.mcp_tool.mcp_session_manager</span> <span class="kn">import</span> <span class="n">SseConnectionParams</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">root_agent</span> <span class="o">=</span> <span class="n">LlmAgent</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">=</span><span class="s2">&#34;gemini-2.0-flash&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span><span class="o">=</span><span class="s2">&#34;wiki_agent&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">instruction</span><span class="o">=</span><span class="s2">&#34;Help users retrieve and summarize Wikipedia articles.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">tools</span><span class="o">=</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="n">McpToolset</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">connection_params</span><span class="o">=</span><span class="n">SseConnectionParams</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">url</span><span class="o">=</span><span class="s2">&#34;http://localhost:8001/sse&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;Authorization&#34;</span><span class="p">:</span> <span class="s2">&#34;Bearer my-api-token&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The <code>SseConnectionParams</code> accept <code>url</code>, optional <code>headers</code> for authentication, a <code>timeout</code> for the initial connection, and an <code>sse_read_timeout</code> for the streaming read.</p>
<h3 id="connecting-via-streamable-http">Connecting via Streamable HTTP</h3>
<p>In March 2025, the MCP specification introduced Streamable HTTP as the successor to SSE. Instead of two separate endpoints, Streamable HTTP uses a single HTTP endpoint for both sending requests and receiving responses. This simplifies deployment and works better with standard HTTP infrastructure, such as load balancers and reverse proxies.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.agents</span> <span class="kn">import</span> <span class="n">LlmAgent</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.tools.mcp_tool</span> <span class="kn">import</span> <span class="n">MCPToolset</span><span class="p">,</span> <span class="n">StreamableHTTPConnectionParams</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">root_agent</span> <span class="o">=</span> <span class="n">LlmAgent</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">=</span><span class="s2">&#34;gemini-2.0-flash&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span><span class="o">=</span><span class="s2">&#34;github_agent&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">instruction</span><span class="o">=</span><span class="s2">&#34;Help users work with GitHub repositories, issues, and pull requests.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">tools</span><span class="o">=</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="n">MCPToolset</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">connection_params</span><span class="o">=</span><span class="n">StreamableHTTPConnectionParams</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">url</span><span class="o">=</span><span class="s2">&#34;https://api.githubcopilot.com/mcp/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">headers</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;Authorization&#34;</span><span class="p">:</span> <span class="s2">&#34;Bearer &#34;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&#34;GITHUB_TOKEN&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>For new MCP server integrations, prefer Streamable HTTP over SSE when the server supports it.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; adk run .<span class="se">\m</span>cp_agent<span class="se">\
</span></span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Running agent github_agent, <span class="nb">type</span> <span class="nb">exit</span> to exit.
</span></span><span class="line"><span class="cl"><span class="o">[</span>user<span class="o">]</span>: get rchaganti/dscresources info   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>github_agent<span class="o">]</span>: The repository name is DSCResources, full name is rchaganti/DSCResources, description is Custom DSC resource modules by PowerShell Magazine, the language is PowerShell, it has <span class="m">62</span> stars, <span class="m">26</span> forks, and <span class="m">13</span> open issues. It was created on 2014-10-13T07:06:17Z and updated on 2024-10-24T03:19:14Z. It is a public repository and the default branch is master.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>user<span class="o">]</span>: 
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="filtering-tools">Filtering tools</h3>
<p>An MCP server might expose dozens of tools, but your agent may only need a handful. Exposing unnecessary tools to the LLM increases token consumption and can confuse the model&rsquo;s tool selection. The <code>tool_filter</code> parameter on <code>McpToolset</code> lets you whitelist only the tools you need.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">McpToolset</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">connection_params</span><span class="o">=</span><span class="n">StdioConnectionParams</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">server_params</span><span class="o">=</span><span class="n">StdioServerParameters</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">command</span><span class="o">=</span><span class="s2">&#34;npx&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;-y&#34;</span><span class="p">,</span> <span class="s2">&#34;@modelcontextprotocol/server-filesystem&#34;</span><span class="p">,</span> <span class="s2">&#34;/home/user/data&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">tool_filter</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;read_file&#34;</span><span class="p">,</span> <span class="s2">&#34;list_directory&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>With this filter, even if the filesystem server exposes tools for writing, moving, or deleting files, only <code>read_file</code> and <code>list_directory</code> will be available to the agent. This is a good practice for both security and performance.</p>
<h3 id="using-mcptoolset-outside-adk-web">Using McpToolset outside adk web</h3>
<p>When you are running your own application loop instead of using <code>adk web</code>, the setup requires a bit more care around async initialization and connection cleanup. The <code>McpToolset</code> must be created asynchronously, and you need to manage the connection lifecycle properly.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">asyncio</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.agents</span> <span class="kn">import</span> <span class="n">LlmAgent</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.sessions</span> <span class="kn">import</span> <span class="n">InMemorySessionService</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.runners</span> <span class="kn">import</span> <span class="n">Runner</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.tools.mcp_tool</span> <span class="kn">import</span> <span class="n">McpToolset</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.tools.mcp_tool.mcp_session_manager</span> <span class="kn">import</span> <span class="n">StdioConnectionParams</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">mcp</span> <span class="kn">import</span> <span class="n">StdioServerParameters</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.genai.types</span> <span class="kn">import</span> <span class="n">Content</span><span class="p">,</span> <span class="n">Part</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">toolset</span> <span class="o">=</span> <span class="n">McpToolset</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">connection_params</span><span class="o">=</span><span class="n">StdioConnectionParams</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">server_params</span><span class="o">=</span><span class="n">StdioServerParameters</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">command</span><span class="o">=</span><span class="s2">&#34;npx&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;-y&#34;</span><span class="p">,</span> <span class="s2">&#34;@modelcontextprotocol/server-filesystem&#34;</span><span class="p">,</span> <span class="s2">&#34;C:</span><span class="se">\\</span><span class="s2">github</span><span class="se">\\</span><span class="s2">google-adk-101&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">tool_filter</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;read_file&#34;</span><span class="p">,</span> <span class="s2">&#34;list_directory&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">agent</span> <span class="o">=</span> <span class="n">LlmAgent</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">model</span><span class="o">=</span><span class="s2">&#34;gemini-2.0-flash&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span><span class="o">=</span><span class="s2">&#34;file_reader&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">instruction</span><span class="o">=</span><span class="s2">&#34;You help users explore files.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="n">toolset</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">session_service</span> <span class="o">=</span> <span class="n">InMemorySessionService</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">runner</span> <span class="o">=</span> <span class="n">Runner</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">app_name</span><span class="o">=</span><span class="s2">&#34;mcp_demo&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">session_service</span><span class="o">=</span><span class="n">session_service</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">session</span> <span class="o">=</span> <span class="k">await</span> <span class="n">session_service</span><span class="o">.</span><span class="n">create_session</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">app_name</span><span class="o">=</span><span class="s2">&#34;mcp_demo&#34;</span><span class="p">,</span> <span class="n">user_id</span><span class="o">=</span><span class="s2">&#34;user1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">user_msg</span> <span class="o">=</span> <span class="n">Content</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">parts</span><span class="o">=</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="n">Part</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">text</span><span class="o">=</span><span class="s2">&#34;What files are in mcp_agent folder?&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">,</span><span class="n">role</span><span class="o">=</span><span class="s2">&#34;user&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">async</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">runner</span><span class="o">.</span><span class="n">run_async</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">user_id</span><span class="o">=</span><span class="s2">&#34;user1&#34;</span><span class="p">,</span> <span class="n">session_id</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">new_message</span><span class="o">=</span><span class="n">user_msg</span>
</span></span><span class="line"><span class="cl">    <span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">is_final_response</span><span class="p">()</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">content</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Agent: </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>When using <code>McpToolset</code> directly in <code>adk web</code>, the framework handles connection setup and teardown automatically. In standalone applications like the one above, the <code>Runner</code> manages the lifecycle of the toolset.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; python.exe .<span class="se">\m</span>cp_agent<span class="se">\a</span>gent.py
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Agent: Okay, the files in the mcp_agent folder are: .adk <span class="o">(</span>directory<span class="o">)</span>, agent.py, __init__.py, and __pycache__ <span class="o">(</span>directory<span class="o">)</span>.
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="connecting-to-multiple-mcp-servers">Connecting to multiple MCP servers</h3>
<p>An agent can consume tools from several MCP servers simultaneously. Each <code>McpToolset</code> manages its own independent connection. You simply list multiple toolsets in the agent&rsquo;s <code>tools</code> parameter.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.agents</span> <span class="kn">import</span> <span class="n">LlmAgent</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.tools.mcp_tool</span> <span class="kn">import</span> <span class="n">McpToolset</span><span class="p">,</span> <span class="n">MCPToolset</span><span class="p">,</span> <span class="n">StreamableHTTPConnectionParams</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.tools.mcp_tool.mcp_session_manager</span> <span class="kn">import</span> <span class="n">StdioConnectionParams</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">mcp</span> <span class="kn">import</span> <span class="n">StdioServerParameters</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">root_agent</span> <span class="o">=</span> <span class="n">LlmAgent</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">=</span><span class="s2">&#34;gemini-2.0-flash&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span><span class="o">=</span><span class="s2">&#34;research_assistant&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">instruction</span><span class="o">=</span><span class="s2">&#34;&#34;&#34;You are a research assistant. 
</span></span></span><span class="line"><span class="cl"><span class="s2">    Use the filesystem tools to read local notes, 
</span></span></span><span class="line"><span class="cl"><span class="s2">    and the GitHub tools to look up repository information.&#34;&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">tools</span><span class="o">=</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Local filesystem server</span>
</span></span><span class="line"><span class="cl">        <span class="n">McpToolset</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">connection_params</span><span class="o">=</span><span class="n">StdioConnectionParams</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">server_params</span><span class="o">=</span><span class="n">StdioServerParameters</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                    <span class="n">command</span><span class="o">=</span><span class="s2">&#34;npx&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;-y&#34;</span><span class="p">,</span> <span class="s2">&#34;@modelcontextprotocol/server-filesystem&#34;</span><span class="p">,</span> <span class="s2">&#34;C:</span><span class="se">\\</span><span class="s2">Github</span><span class="se">\\</span><span class="s2">google-adk-101&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">tool_filter</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;read_file&#34;</span><span class="p">,</span> <span class="s2">&#34;list_directory&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Remote GitHub server</span>
</span></span><span class="line"><span class="cl">        <span class="n">MCPToolset</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">connection_params</span><span class="o">=</span><span class="n">StreamableHTTPConnectionParams</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">url</span><span class="o">=</span><span class="s2">&#34;https://api.githubcopilot.com/mcp/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;Authorization&#34;</span><span class="p">:</span> <span class="s2">&#34;Bearer &#34;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&#34;GITHUB_TOKEN&#34;</span><span class="p">]},</span>
</span></span><span class="line"><span class="cl">            <span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The LLM sees all the tools from both servers in a single flat list and can combine them freely within a single conversation.</p>
<h2 id="exposing-adk-tools-as-an-mcp-server">Exposing ADK tools as an MCP server</h2>
<p>The second integration pattern is the reverse direction. You have tool functions built with ADK, and you want to make them available to any MCP client, not just ADK agents. This is useful when other teams or frameworks in your organization need access to the same tools.</p>
<p>ADK provides a conversion utility, <code>adk_to_mcp_tool_type</code>, that translates ADK tool definitions into MCP-compatible schemas. You then wrap these inside a standard MCP server built with the <code>mcp</code> Python library.</p>
<h3 id="building-the-mcp-server">Building the MCP server</h3>
<p>Here is a complete example. We will create a simple ADK tool that checks the health of a set of service endpoints, then expose it through an MCP server.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># health_check_mcp_server.py</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">asyncio</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">mcp</span> <span class="kn">import</span> <span class="n">types</span> <span class="k">as</span> <span class="n">mcp_types</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">mcp.server.lowlevel</span> <span class="kn">import</span> <span class="n">Server</span><span class="p">,</span> <span class="n">NotificationOptions</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">mcp.server.models</span> <span class="kn">import</span> <span class="n">InitializationOptions</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">mcp.server.stdio</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.tools.function_tool</span> <span class="kn">import</span> <span class="n">FunctionTool</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.tools.mcp_tool.conversion_utils</span> <span class="kn">import</span> <span class="n">adk_to_mcp_tool_type</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">check_service_health</span><span class="p">(</span><span class="n">service_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Checks the health status of a named service.&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># In a real application, this would ping the actual service</span>
</span></span><span class="line"><span class="cl">    <span class="n">health_data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;payments&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;status&#34;</span><span class="p">:</span> <span class="s2">&#34;healthy&#34;</span><span class="p">,</span> <span class="s2">&#34;latency_ms&#34;</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span> <span class="s2">&#34;uptime&#34;</span><span class="p">:</span> <span class="s2">&#34;99.97%&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;inventory&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;status&#34;</span><span class="p">:</span> <span class="s2">&#34;degraded&#34;</span><span class="p">,</span> <span class="s2">&#34;latency_ms&#34;</span><span class="p">:</span> <span class="mi">320</span><span class="p">,</span> <span class="s2">&#34;uptime&#34;</span><span class="p">:</span> <span class="s2">&#34;98.5%&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;auth&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;status&#34;</span><span class="p">:</span> <span class="s2">&#34;healthy&#34;</span><span class="p">,</span> <span class="s2">&#34;latency_ms&#34;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">&#34;uptime&#34;</span><span class="p">:</span> <span class="s2">&#34;99.99%&#34;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">health_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">service_name</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="s2">&#34;status&#34;</span><span class="p">:</span> <span class="s2">&#34;unknown&#34;</span><span class="p">,</span> <span class="s2">&#34;error&#34;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;No service found with name &#39;</span><span class="si">{</span><span class="n">service_name</span><span class="si">}</span><span class="s2">&#39;&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span><span class="p">[</span><span class="s2">&#34;service&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">service_name</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Wrap the Python function as an ADK FunctionTool</span>
</span></span><span class="line"><span class="cl"><span class="n">health_tool</span> <span class="o">=</span> <span class="n">FunctionTool</span><span class="p">(</span><span class="n">check_service_health</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Create the MCP server</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="s2">&#34;health-check-server&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.list_tools</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">list_tools</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">mcp_types</span><span class="o">.</span><span class="n">Tool</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Advertise our ADK tool in MCP format.&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">[</span><span class="n">adk_to_mcp_tool_type</span><span class="p">(</span><span class="n">health_tool</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.call_tool</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">call_tool</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">mcp_types</span><span class="o">.</span><span class="n">TextContent</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Route incoming MCP tool calls to the ADK tool.&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">health_tool</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">health_tool</span><span class="o">.</span><span class="n">run_async</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="n">arguments</span><span class="p">,</span> <span class="n">tool_context</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">[</span><span class="n">mcp_types</span><span class="o">.</span><span class="n">TextContent</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">[</span><span class="n">mcp_types</span><span class="o">.</span><span class="n">TextContent</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="nb">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">text</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&#34;error&#34;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;Unknown tool: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="p">)]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">run_server</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">async</span> <span class="k">with</span> <span class="n">mcp</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">stdio</span><span class="o">.</span><span class="n">stdio_server</span><span class="p">()</span> <span class="k">as</span> <span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="n">writer</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">await</span> <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">reader</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">InitializationOptions</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">server_name</span><span class="o">=</span><span class="n">app</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">server_version</span><span class="o">=</span><span class="s2">&#34;0.1.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">capabilities</span><span class="o">=</span><span class="n">app</span><span class="o">.</span><span class="n">get_capabilities</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                    <span class="n">notification_options</span><span class="o">=</span><span class="n">NotificationOptions</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">                    <span class="n">experimental_capabilities</span><span class="o">=</span><span class="p">{},</span>
</span></span><span class="line"><span class="cl">                <span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">run_server</span><span class="p">())</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The <code>adk_to_mcp_tool_type(health_tool)</code> call reads the function signature, docstring, and type hints from the ADK <code>FunctionTool</code> and converts them into the MCP <code>Tool</code> schema that clients expect. The <code>call_tool</code> handler receives calls from any MCP client, executes the underlying ADK tool, and returns the result in MCP format.</p>
<p>Note that <code>tool_context</code> is <code>None</code> when running outside of a full ADK <code>Runner</code> invocation. If your tool relies on features from <code>ToolContext,</code> such as session state or artifacts, you will need additional handling to provide that context.</p>
<h3 id="testing-with-an-adk-agent">Testing with an ADK agent</h3>
<p>Now we can test this server by connecting an ADK agent to it as a client. The agent treats our custom MCP server exactly like any other MCP server.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># agent.py</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.agents</span> <span class="kn">import</span> <span class="n">LlmAgent</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.tools.mcp_tool</span> <span class="kn">import</span> <span class="n">McpToolset</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.tools.mcp_tool.mcp_session_manager</span> <span class="kn">import</span> <span class="n">StdioConnectionParams</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">mcp</span> <span class="kn">import</span> <span class="n">StdioServerParameters</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get path relative to this agent.py file</span>
</span></span><span class="line"><span class="cl"><span class="n">_AGENT_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">MCP_SERVER_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_AGENT_DIR</span><span class="p">,</span> <span class="s2">&#34;health_check_mcp_server.py&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">root_agent</span> <span class="o">=</span> <span class="n">LlmAgent</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">=</span><span class="s2">&#34;gemini-2.0-flash&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span><span class="o">=</span><span class="s2">&#34;ops_assistant&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">instruction</span><span class="o">=</span><span class="s2">&#34;You are an operations assistant. Check the health of services when asked.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">tools</span><span class="o">=</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="n">McpToolset</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">connection_params</span><span class="o">=</span><span class="n">StdioConnectionParams</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">server_params</span><span class="o">=</span><span class="n">StdioServerParameters</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                    <span class="n">command</span><span class="o">=</span><span class="s2">&#34;python&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">MCP_SERVER_PATH</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="n">timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>When this agent runs and a user asks &ldquo;How is the payments service doing?&rdquo;, the LLM will invoke the <code>check_service_health</code> tool through the MCP protocol, and the server will execute the ADK tool function and return the health data.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; adk run .<span class="se">\m</span>cp_agent<span class="se">\
</span></span></span><span class="line"><span class="cl">Running agent ops_assistant, <span class="nb">type</span> <span class="nb">exit</span> to exit.
</span></span><span class="line"><span class="cl"><span class="o">[</span>user<span class="o">]</span>: How is the payments service doing?
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>ops_assistant<span class="o">]</span>: The payments service is healthy with a latency of 45ms and uptime of 99.97%.
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="using-fastmcp-for-simpler-server-creation">Using FastMCP for simpler server creation</h3>
<p>For quick server development, you can use <code>FastMCP</code>, which ADK leverages internally. With FastMCP, you decorate your tool functions directly and skip the boilerplate of manually implementing <code>list_tools</code> and <code>call_tool</code> handlers.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># fast_mcp_server.py</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">mcp.server.fastmcp</span> <span class="kn">import</span> <span class="n">FastMCP</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mcp</span> <span class="o">=</span> <span class="n">FastMCP</span><span class="p">(</span><span class="s2">&#34;weather-service&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@mcp.tool</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_current_temperature</span><span class="p">(</span><span class="n">city</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Gets the current temperature for a given city.&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Simulated data</span>
</span></span><span class="line"><span class="cl">    <span class="n">temps</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;london&#34;</span><span class="p">:</span> <span class="s2">&#34;14°C&#34;</span><span class="p">,</span> <span class="s2">&#34;tokyo&#34;</span><span class="p">:</span> <span class="s2">&#34;22°C&#34;</span><span class="p">,</span> <span class="s2">&#34;new york&#34;</span><span class="p">:</span> <span class="s2">&#34;18°C&#34;</span><span class="p">,</span> <span class="s2">&#34;mumbai&#34;</span><span class="p">:</span> <span class="s2">&#34;32°C&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">temps</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">city</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="sa">f</span><span class="s2">&#34;No data available for </span><span class="si">{</span><span class="n">city</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@mcp.tool</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_weather_forecast</span><span class="p">(</span><span class="n">city</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Gets a weather forecast for a city for the specified number of days.&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;Forecast for </span><span class="si">{</span><span class="n">city</span><span class="si">}</span><span class="s2"> over </span><span class="si">{</span><span class="n">days</span><span class="si">}</span><span class="s2"> days: Mostly sunny with occasional clouds.&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">mcp</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">transport</span><span class="o">=</span><span class="s2">&#34;stdio&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This FastMCP server can be consumed by any ADK agent using <code>StdioConnectionParams</code> pointing to <code>python3 fast_mcp_server.py</code>. For remote deployment, you can switch the transport to Streamable HTTP and run the server behind an ASGI server such as <code>Uvicorn</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># remote_fast_mcp_server.py</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">uvicorn</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">mcp.server.fastmcp</span> <span class="kn">import</span> <span class="n">FastMCP</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mcp</span> <span class="o">=</span> <span class="n">FastMCP</span><span class="p">(</span><span class="s2">&#34;weather-service&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@mcp.tool</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_current_temperature</span><span class="p">(</span><span class="n">city</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Gets the current temperature for a given city.&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Simulated data</span>
</span></span><span class="line"><span class="cl">    <span class="n">temps</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;london&#34;</span><span class="p">:</span> <span class="s2">&#34;14°C&#34;</span><span class="p">,</span> <span class="s2">&#34;tokyo&#34;</span><span class="p">:</span> <span class="s2">&#34;22°C&#34;</span><span class="p">,</span> <span class="s2">&#34;new york&#34;</span><span class="p">:</span> <span class="s2">&#34;18°C&#34;</span><span class="p">,</span> <span class="s2">&#34;mumbai&#34;</span><span class="p">:</span> <span class="s2">&#34;32°C&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">temps</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">city</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="sa">f</span><span class="s2">&#34;No data available for </span><span class="si">{</span><span class="n">city</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@mcp.tool</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_weather_forecast</span><span class="p">(</span><span class="n">city</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Gets a weather forecast for a city for the specified number of days.&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;Forecast for </span><span class="si">{</span><span class="n">city</span><span class="si">}</span><span class="s2"> over </span><span class="si">{</span><span class="n">days</span><span class="si">}</span><span class="s2"> days: Mostly sunny with occasional clouds.&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">mcp</span><span class="o">.</span><span class="n">streamable_http_app</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">uvicorn</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s2">&#34;0.0.0.0&#34;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3000</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>An ADK agent then connects using <code>StreamableHTTPConnectionParams</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.agents</span> <span class="kn">import</span> <span class="n">LlmAgent</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.tools.mcp_tool</span> <span class="kn">import</span> <span class="n">MCPToolset</span><span class="p">,</span> <span class="n">StreamableHTTPConnectionParams</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">root_agent</span> <span class="o">=</span> <span class="n">LlmAgent</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">=</span><span class="s2">&#34;gemini-2.0-flash&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span><span class="o">=</span><span class="s2">&#34;weather_agent&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">instruction</span><span class="o">=</span><span class="s2">&#34;Provide weather information when asked.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">tools</span><span class="o">=</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="n">MCPToolset</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">connection_params</span><span class="o">=</span><span class="n">StreamableHTTPConnectionParams</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">url</span><span class="o">=</span><span class="s2">&#34;http://localhost:3000/mcp&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">&gt; adk run .<span class="se">\m</span>cp_agent<span class="se">\ </span> 
</span></span><span class="line"><span class="cl">Running agent weather_agent, <span class="nb">type</span> <span class="nb">exit</span> to exit.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>user<span class="o">]</span>: how is weather in Bengaluru?
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>weather_agent<span class="o">]</span>: I am sorry, I cannot fulfill this request. I <span class="k">do</span> not have the weather information <span class="k">for</span> Bengaluru.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>user<span class="o">]</span>: how is weather in london?   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>weather_agent<span class="o">]</span>: The current temperature in London is 14°C.
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="key-considerations">Key considerations</h2>
<p>There are several important points to keep in mind when working with MCP tools in ADK.</p>
<h3 id="statefulness">Statefulness</h3>
<p>MCP establishes stateful, persistent connections between client and server. This is different from typical stateless REST APIs and has implications for scaling and deployment. When deploying remote MCP servers, you need to think about session affinity, load balancing, and connection pooling. The <code>McpToolset</code> manages this connection lifecycle for you within the agent process.</p>
<h3 id="async-nature">Async nature</h3>
<p>Both ADK and the MCP Python library are built on Python&rsquo;s <code>asyncio</code>. Tool implementations and server handlers should generally be async functions. The <code>McpToolset</code> handles the async communication transparently, but if you are building custom MCP servers, your tool handlers should follow async patterns.</p>
<h3 id="deployment-considerations">Deployment considerations</h3>
<p>When deploying ADK agents with MCP tools to production environments like Cloud Run or Vertex AI Agent Engine, the agent and <code>McpToolset</code> must be defined synchronously in your <code>agent.py</code> file. While <code>adk web</code> allows for asynchronous agent creation, deployment environments require synchronous instantiation.</p>
<p>For Stdio-based MCP servers, the server binary or script must be included in the deployment container since the agent spawns it as a subprocess. For remote servers using SSE or Streamable HTTP, you deploy the MCP server independently and configure your agent with the server&rsquo;s URL.</p>
<p>A production deployment checklist for agents using MCP tools includes:</p>
<ul>
<li>Ensuring MCP server binaries are bundled in the container image for Stdio transports</li>
<li>Configuring health checks for remote MCP server connections</li>
<li>Setting appropriate timeouts on <code>SseConnectionParams</code> or <code>StreamableHTTPConnectionParams</code></li>
<li>Implementing authentication headers for remote servers, and monitoring connection stability.</li>
</ul>
<h3 id="pre-built-mcp-tools">Pre-built MCP tools</h3>
<p>ADK offers a growing catalog of pre-built MCP tool integrations for popular services. These include integrations with Atlassian (Jira and Confluence), Google Cloud services via the API Registry, and generative media services such as Imagen and Veo. You can find the full list in the ADK documentation under Tools and Integrations. Using a prebuilt integration is as simple as adding the appropriate <code>McpToolset</code> with the correct connection parameters, as we demonstrated earlier with the filesystem and Google Maps examples.</p>
<h2 id="putting-it-all-together">Putting it all together</h2>
<p>Here is a complete example that combines consuming an MCP server with tool filtering and session state tracking. The agent uses a local filesystem MCP server to read project notes, while also maintaining conversation context through ADK&rsquo;s session state.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span><span class="lnt">95
</span><span class="lnt">96
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">asyncio</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.agents</span> <span class="kn">import</span> <span class="n">LlmAgent</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.sessions</span> <span class="kn">import</span> <span class="n">InMemorySessionService</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.runners</span> <span class="kn">import</span> <span class="n">Runner</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.tools</span> <span class="kn">import</span> <span class="n">ToolContext</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.tools.mcp_tool</span> <span class="kn">import</span> <span class="n">McpToolset</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.adk.tools.mcp_tool.mcp_session_manager</span> <span class="kn">import</span> <span class="n">StdioConnectionParams</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">mcp</span> <span class="kn">import</span> <span class="n">StdioServerParameters</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">google.genai.types</span> <span class="kn">import</span> <span class="n">Content</span><span class="p">,</span> <span class="n">Part</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">summarize_findings</span><span class="p">(</span><span class="n">summary</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tool_context</span><span class="p">:</span> <span class="n">ToolContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Records a summary of findings from the file research.&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">summaries</span> <span class="o">=</span> <span class="n">tool_context</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;research_summaries&#34;</span><span class="p">,</span> <span class="p">[])</span>
</span></span><span class="line"><span class="cl">    <span class="n">summaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">tool_context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&#34;research_summaries&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">summaries</span>
</span></span><span class="line"><span class="cl">    <span class="n">tool_context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&#34;total_summaries&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">summaries</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;status&#34;</span><span class="p">:</span> <span class="s2">&#34;recorded&#34;</span><span class="p">,</span> <span class="s2">&#34;total_summaries&#34;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">summaries</span><span class="p">)}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">NOTES_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&#34;~/project-notes&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">research_agent</span> <span class="o">=</span> <span class="n">LlmAgent</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">=</span><span class="s2">&#34;gemini-2.0-flash&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span><span class="o">=</span><span class="s2">&#34;ResearchAgent&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">instruction</span><span class="o">=</span><span class="s2">&#34;&#34;&#34;You are a research assistant. 
</span></span></span><span class="line"><span class="cl"><span class="s2">Use file tools to read notes from the project directory. 
</span></span></span><span class="line"><span class="cl"><span class="s2">After reading relevant files, use the summarize_findings tool 
</span></span></span><span class="line"><span class="cl"><span class="s2">to record your analysis.
</span></span></span><span class="line"><span class="cl"><span class="s2">Total summaries recorded so far: {total_summaries?}&#34;&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">tools</span><span class="o">=</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="n">McpToolset</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">connection_params</span><span class="o">=</span><span class="n">StdioConnectionParams</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">server_params</span><span class="o">=</span><span class="n">StdioServerParameters</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                    <span class="n">command</span><span class="o">=</span><span class="s2">&#34;npx&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">args</span><span class="o">=</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;-y&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="s2">&#34;@modelcontextprotocol/server-filesystem&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">NOTES_DIR</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                    <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">tool_filter</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;read_file&#34;</span><span class="p">,</span> <span class="s2">&#34;list_directory&#34;</span><span class="p">,</span> <span class="s2">&#34;search_files&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">summarize_findings</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="n">output_key</span><span class="o">=</span><span class="s2">&#34;last_response&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">session_service</span> <span class="o">=</span> <span class="n">InMemorySessionService</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">runner</span> <span class="o">=</span> <span class="n">Runner</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">agent</span><span class="o">=</span><span class="n">research_agent</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">app_name</span><span class="o">=</span><span class="s2">&#34;research_app&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">session_service</span><span class="o">=</span><span class="n">session_service</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">session</span> <span class="o">=</span> <span class="k">await</span> <span class="n">session_service</span><span class="o">.</span><span class="n">create_session</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">app_name</span><span class="o">=</span><span class="s2">&#34;research_app&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">user_id</span><span class="o">=</span><span class="s2">&#34;researcher_1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">state</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;total_summaries&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Turn 1: Explore available files</span>
</span></span><span class="line"><span class="cl">    <span class="n">msg1</span> <span class="o">=</span> <span class="n">Content</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">parts</span><span class="o">=</span><span class="p">[</span><span class="n">Part</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&#34;What project notes do we have available?&#34;</span><span class="p">)],</span>
</span></span><span class="line"><span class="cl">        <span class="n">role</span><span class="o">=</span><span class="s2">&#34;user&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">async</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">runner</span><span class="o">.</span><span class="n">run_async</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">user_id</span><span class="o">=</span><span class="s2">&#34;researcher_1&#34;</span><span class="p">,</span> <span class="n">session_id</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">new_message</span><span class="o">=</span><span class="n">msg1</span>
</span></span><span class="line"><span class="cl">    <span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">is_final_response</span><span class="p">()</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Agent: </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Turn 2: Read and summarize a specific file</span>
</span></span><span class="line"><span class="cl">    <span class="n">msg2</span> <span class="o">=</span> <span class="n">Content</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">parts</span><span class="o">=</span><span class="p">[</span><span class="n">Part</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&#34;Read the architecture.md file and summarize the key decisions.&#34;</span><span class="p">)],</span>
</span></span><span class="line"><span class="cl">        <span class="n">role</span><span class="o">=</span><span class="s2">&#34;user&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">async</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">runner</span><span class="o">.</span><span class="n">run_async</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">user_id</span><span class="o">=</span><span class="s2">&#34;researcher_1&#34;</span><span class="p">,</span> <span class="n">session_id</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">new_message</span><span class="o">=</span><span class="n">msg2</span>
</span></span><span class="line"><span class="cl">    <span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">is_final_response</span><span class="p">()</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Agent: </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Check state</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="k">await</span> <span class="n">session_service</span><span class="o">.</span><span class="n">get_session</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">app_name</span><span class="o">=</span><span class="s2">&#34;research_app&#34;</span><span class="p">,</span> <span class="n">user_id</span><span class="o">=</span><span class="s2">&#34;researcher_1&#34;</span><span class="p">,</span> <span class="n">session_id</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="n">id</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;State: total_summaries=</span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;total_summaries&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;State: research_summaries=</span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;research_summaries&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This example demonstrates a common pattern in real applications:</p>
<ul>
<li>Combining external tools from an MCP server with custom ADK tools that maintain state.</li>
<li>The filesystem tools handle file operations</li>
<li>The <code>summarize_findings</code> function records analysis in the session state using <code>ToolContext</code></li>
<li>The agent&rsquo;s instruction template dynamically reflects the current summary count.</li>
</ul>
<p>Understanding how to consume and expose MCP tools with ADK opens up a broad ecosystem of reusable capabilities for your agents. The <code>McpToolset</code> class makes it straightforward to connect to any MCP-compliant server, regardless of the transport mechanism, while ADK&rsquo;s conversion utilities let you share your tools with the wider MCP ecosystem. I recommend starting with a community MCP server, such as the Filesystem or GitHub examples, to get comfortable with the pattern, then build your own servers for custom capabilities.</p>

        </div>

        
        

        
        

<div class="mt-12 pt-8 border-t border-gray-200 dark:border-dark-border">
  <h3 class="text-lg font-bold mb-4 text-center text-gray-900 dark:text-dark-text">Share this article</h3>
  <div class="flex flex-wrap justify-center items-center gap-3 sm:gap-4">
    
    <button onclick="shareNative()"
      class="sm:hidden w-12 h-12 rounded-full bg-white dark:bg-dark-bg-secondary border-2 border-primary text-primary dark:border-blue-400 dark:text-blue-400 flex items-center justify-center transition-all shadow-sm hover:shadow-md hover:bg-primary hover:text-white dark:hover:bg-blue-600 dark:hover:text-white dark:hover:border-blue-600"
      aria-label="Share" title="Share" id="native-share-btn">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z">
        </path>
      </svg>
    </button>

    
    <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fravichaganti.com%2Fblog%2Fgoogle-adk-mcp-tools%2F&text=Google&#43;ADK&#43;-&#43;MCP&#43;tools"
      target="_blank" rel="noopener noreferrer"
      class="w-12 h-12 rounded-full bg-white dark:bg-dark-bg-secondary border-2 border-[#1DA1F2] text-[#1DA1F2] flex items-center justify-center transition-all no-underline shadow-sm hover:shadow-md hover:bg-[#1DA1F2] hover:text-white hover:scale-105"
      aria-label="Share on Twitter" title="Share on Twitter">
      <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
        <path
          d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z" />
      </svg>
    </a>

    
    <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fravichaganti.com%2Fblog%2Fgoogle-adk-mcp-tools%2F" target="_blank"
      rel="noopener noreferrer"
      class="w-12 h-12 rounded-full bg-white dark:bg-dark-bg-secondary border-2 border-[#0077B5] text-[#0077B5] flex items-center justify-center transition-all no-underline shadow-sm hover:shadow-md hover:bg-[#0077B5] hover:text-white hover:scale-105"
      aria-label="Share on LinkedIn" title="Share on LinkedIn">
      <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
        <path
          d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" />
      </svg>
    </a>

    
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fravichaganti.com%2Fblog%2Fgoogle-adk-mcp-tools%2F" target="_blank"
      rel="noopener noreferrer"
      class="w-12 h-12 rounded-full bg-white dark:bg-dark-bg-secondary border-2 border-[#1877F2] text-[#1877F2] flex items-center justify-center transition-all no-underline shadow-sm hover:shadow-md hover:bg-[#1877F2] hover:text-white hover:scale-105"
      aria-label="Share on Facebook" title="Share on Facebook">
      <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
        <path
          d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" />
      </svg>
    </a>

    
    <a href="https://www.reddit.com/submit?url=https%3A%2F%2Fravichaganti.com%2Fblog%2Fgoogle-adk-mcp-tools%2F&title=Google&#43;ADK&#43;-&#43;MCP&#43;tools"
      target="_blank" rel="noopener noreferrer"
      class="w-12 h-12 rounded-full bg-white dark:bg-dark-bg-secondary border-2 border-[#FF4500] text-[#FF4500] flex items-center justify-center transition-all no-underline shadow-sm hover:shadow-md hover:bg-[#FF4500] hover:text-white hover:scale-105"
      aria-label="Share on Reddit" title="Share on Reddit">
      <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
        <path
          d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z" />
      </svg>
    </a>

    
    <a href="https://news.ycombinator.com/submitlink?u=https%3A%2F%2Fravichaganti.com%2Fblog%2Fgoogle-adk-mcp-tools%2F&t=Google&#43;ADK&#43;-&#43;MCP&#43;tools"
      target="_blank" rel="noopener noreferrer"
      class="w-12 h-12 rounded-full bg-white dark:bg-dark-bg-secondary border-2 border-[#FF6600] text-[#FF6600] flex items-center justify-center transition-all no-underline shadow-sm hover:shadow-md hover:bg-[#FF6600] hover:text-white hover:scale-105"
      aria-label="Share on Hacker News" title="Share on Hacker News">
      <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
        <path d="M0 0v24h24V0H0zm12.8 13.4v5.2H11v-5.2L6.6 5.4h2.1l3.3 6.2 3.3-6.2h2.1l-4.6 8z" />
      </svg>
    </a>

    
    <button onclick="copyToClipboard('https:\/\/ravichaganti.com\/blog\/google-adk-mcp-tools\/')"
      class="w-12 h-12 rounded-full bg-white dark:bg-dark-bg-secondary border-2 border-amber-500 text-amber-500 flex items-center justify-center transition-all shadow-sm hover:shadow-md hover:bg-amber-500 hover:text-white hover:scale-105"
      aria-label="Copy link" title="Copy link" id="copy-link-btn">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z">
        </path>
      </svg>
    </button>
  </div>
</div>

<script>
  
  function shareNative() {
    if (navigator.share) {
      navigator.share({
        title: 'Google ADK - MCP tools',
        text: 'An agent that can only use the tools you hard-code into it has a ceiling. The Model Context Protocol (MCP) shatters that ceiling by giving your ADK agents a standardized way to discover and use tools hosted anywhere — local processes, remote servers, or cloud services.',
        url: 'https:\/\/ravichaganti.com\/blog\/google-adk-mcp-tools\/'
      }).catch(function (error) {
        console.log('Error sharing:', error);
      });
    }
  }

  
  function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(function () {
      const btn = document.getElementById('copy-link-btn');
      const originalHTML = btn.innerHTML;
      const originalTitle = btn.title;

      
      btn.innerHTML = '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>';
      btn.title = 'Copied!';

      
      setTimeout(function () {
        btn.innerHTML = originalHTML;
        btn.title = originalTitle;
      }, 2000);
    }).catch(function (error) {
      console.error('Failed to copy:', error);
      alert('Failed to copy link. Please copy manually: ' + text);
    });
  }
</script>


        
        
<nav class="mt-12 pt-8 border-t border-gray-200 dark:border-dark-border" aria-label="Post navigation">
  
  
  
  

  
  
  
    
    
    

    
    
    

    
    
    
      
    
      
    
      
    
      
    
      
    
      
        
      
    
      
    
      
    
      
    

    
    
      
        
        
      
      
        
        
      
    
  

  
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    
    <div class="flex">
      
        <a href="https://ravichaganti.com/blog/google-adk-runner-and-execution-architecture/"
           class="flex-1 group card hover:shadow-xl transition-all hover:scale-[1.02] no-underline"
           aria-label="Previous in Google ADK: Google ADK - Runner and execution architecture">
          <div class="flex items-start gap-3">
            
            <div class="flex-shrink-0 text-primary dark:text-blue-400 group-hover:text-secondary dark:group-hover:text-purple-400 transition-colors mt-1">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
              </svg>
            </div>

            
            <div class="flex-1 min-w-0">
              <p class="text-xs text-gray-500 dark:text-dark-text-muted mb-1 uppercase tracking-wide">Previous in Google ADK</p>
              <h3 class="text-base font-bold text-gray-900 dark:text-dark-text mb-2 group-hover:text-primary dark:group-hover:text-blue-400 transition-colors">
                Google ADK - Runner and execution architecture
              </h3>
              
                <p class="text-sm text-gray-600 dark:text-dark-text-secondary line-clamp-2">You have agents, tools, callbacks, and sessions. But what actually runs them? The Runner is the central orchestrator that powers every agent interaction in Google ADK, driving the event loop that connects all these pieces together.</p>
              
            </div>
          </div>
        </a>
      
    </div>

    
    <div class="flex">
      
        <a href="https://ravichaganti.com/blog/google-adk-openapi-tools-agents-as-tools-authentication-and-long-running-operations/"
           class="flex-1 group card hover:shadow-xl transition-all hover:scale-[1.02] no-underline"
           aria-label="Next in Google ADK: Google ADK - OpenAPI tools, agents-as-tools, authentication, and long-running operations">
          <div class="flex items-start gap-3">
            
            <div class="flex-1 min-w-0 text-right md:text-left md:order-1">
              <p class="text-xs text-gray-500 dark:text-dark-text-muted mb-1 uppercase tracking-wide">Next in Google ADK</p>
              <h3 class="text-base font-bold text-gray-900 dark:text-dark-text mb-2 group-hover:text-primary dark:group-hover:text-blue-400 transition-colors">
                Google ADK - OpenAPI tools, agents-as-tools, authentication, and long-running operations
              </h3>
              
                <p class="text-sm text-gray-600 dark:text-dark-text-secondary line-clamp-2">Your agent needs to talk to the outside world. It needs to call REST APIs, delegate complex work to specialized agents, authenticate with protected services, and kick off operations that take minutes instead of milliseconds. Google ADK provides four powerful patterns to make all of this possible.</p>
              
            </div>

            
            <div class="flex-shrink-0 text-primary dark:text-blue-400 group-hover:text-secondary dark:group-hover:text-purple-400 transition-colors mt-1 md:order-2">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
              </svg>
            </div>
          </div>
        </a>
      
    </div>
  </div>
</nav>


        
        

        
        

        
        

<div class="comments-section mt-12 pt-8 border-t border-gray-200 dark:border-dark-border">
  <h3 class="text-xl sm:text-2xl font-bold mb-6 text-gray-900 dark:text-dark-text">Comments</h3>

  
  <div id="comments-placeholder" class="hidden">
    <div class="bg-gray-100 dark:bg-dark-bg border-2 border-dashed border-gray-300 dark:border-dark-border rounded-lg p-8 text-center">
      <svg class="w-12 h-12 mx-auto mb-4 text-gray-400 dark:text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
      </svg>
      <h4 class="text-lg font-semibold text-gray-900 dark:text-dark-text mb-2">
        Comments Require Consent
      </h4>
      <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">
        The comment system (Giscus) uses GitHub and may set authentication cookies.
        Enable comments to join the discussion.
      </p>
      <button onclick="window.cookieConsent.enableComments()"
              class="px-6 py-2 bg-primary hover:bg-blue-700 text-white font-medium rounded-lg transition-colors">
        Enable Comments
      </button>
    </div>
  </div>

  
  <div id="giscus-wrapper" class="giscus-wrapper"></div>

  
  <script>
    (function() {
      'use strict';

      let giscusLoaded = false;
      let themeObserver = null;

      
      function loadGiscus() {
        if (giscusLoaded) return;

        const wrapper = document.getElementById('giscus-wrapper');
        const placeholder = document.getElementById('comments-placeholder');

        if (!wrapper) return;

        
        if (placeholder) placeholder.classList.add('hidden');
        wrapper.classList.remove('hidden');

        
        const script = document.createElement('script');
        script.src = 'https://giscus.app/client.js';
        script.setAttribute('data-repo', 'rchaganti\/rchaganti.github.io');
        script.setAttribute('data-repo-id', 'MDEwOlJlcG9zaXRvcnkyNzcwNTE0Mjc=');
        script.setAttribute('data-category', 'Announcements');
        script.setAttribute('data-category-id', 'DIC_kwDOEIN4I84CS4rW');
        script.setAttribute('data-mapping', 'pathname');
        script.setAttribute('data-strict', '0');
        script.setAttribute('data-reactions-enabled', '1');
        script.setAttribute('data-emit-metadata', '0');
        script.setAttribute('data-input-position', 'bottom');
        script.setAttribute('data-theme', 'light');
        script.setAttribute('data-lang', 'en');
        script.setAttribute('data-loading', 'lazy');
        script.setAttribute('crossorigin', 'anonymous');
        script.async = true;

        wrapper.appendChild(script);
        giscusLoaded = true;

        
        setupThemeObserver();
      }

      
      function updateGiscusTheme() {
        const isDark = document.documentElement.classList.contains('dark');
        const theme = isDark ? 'dark' : 'light';

        const iframe = document.querySelector('iframe.giscus-frame');
        if (iframe) {
          iframe.contentWindow.postMessage(
            { giscus: { setConfig: { theme: theme } } },
            'https://giscus.app'
          );
        }
      }

      
      function setupThemeObserver() {
        if (themeObserver) return;

        
        themeObserver = new MutationObserver(function(mutations) {
          mutations.forEach(function(mutation) {
            if (mutation.attributeName === 'class') {
              updateGiscusTheme();
            }
          });
        });

        themeObserver.observe(document.documentElement, {
          attributes: true,
          attributeFilter: ['class']
        });

        
        window.addEventListener('message', function(event) {
          if (event.origin !== 'https://giscus.app') return;
          if (!(typeof event.data === 'object' && event.data.giscus)) return;

          
          if (event.data.giscus.discussion) {
            updateGiscusTheme();
          }
        });
      }

      
      function checkConsentAndLoad() {
        if (window.cookieConsent && window.cookieConsent.hasConsent('comments')) {
          loadGiscus();
        } else {
          
          const placeholder = document.getElementById('comments-placeholder');
          if (placeholder) placeholder.classList.remove('hidden');
        }
      }

      
      window.addEventListener('loadComments', loadGiscus);
      window.addEventListener('consentChanged', checkConsentAndLoad);

      
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', checkConsentAndLoad);
      } else {
        checkConsentAndLoad();
      }
    })();
  </script>
</div>


      </div>
      

      
      <aside class="hidden lg:block relative">
        <div class="mb-6">
          
<div class="bg-white dark:bg-dark-bg-secondary rounded-xl shadow-md dark:shadow-lg dark:shadow-black/20 p-6 mb-6">
  <div class="flex items-center gap-3 mb-4">
    <div class="w-10 h-10 bg-[#0A66C2]/10 rounded-full flex items-center justify-center">
      <svg class="w-5 h-5 text-[#0A66C2]" fill="currentColor" viewBox="0 0 24 24">
        <path
          d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" />
      </svg>
    </div>
    <h3 class="font-semibold text-gray-900 dark:text-dark-text">Newsletter</h3>
  </div>
  <p class="text-sm text-gray-600 dark:text-dark-text-secondary mb-4">
    Get notified about new articles on cloud, AI, and infrastructure.
  </p>
  <a href="https://www.linkedin.com/build-relation/newsletter-follow?entityUrn=7418529089365520384" target="_blank"
    rel="noopener noreferrer"
    class="flex items-center justify-center gap-2 w-full px-4 py-2 bg-[#0A66C2] hover:bg-[#004182] !text-white text-sm font-semibold rounded-lg transition-colors no-underline">
    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
      <path
        d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" />
    </svg>
    Subscribe on LinkedIn
  </a>
</div>
        </div>
        <div class="mb-6">
          


  <div class="bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700">
    <h3 class="text-lg font-bold mb-4 text-gray-900 dark:text-gray-100">
      You May Also Like
    </h3>
    <div>
      
        
<article class="mb-4 pb-4 border-b border-gray-200 dark:border-gray-700 last:border-b-0 last:mb-0 last:pb-0">
  <a href="https://ravichaganti.com/blog/google-adk-openapi-tools-agents-as-tools-authentication-and-long-running-operations/" class="no-underline block group">
    
    <h4 class="text-sm font-bold text-gray-900 dark:text-gray-100 group-hover:text-primary dark:group-hover:text-blue-400 transition-colors line-clamp-2 mb-1">
      Google ADK - OpenAPI tools, agents-as-tools, authentication, and long-running operations
    </h4>

    
    <time class="text-xs text-gray-500 dark:text-gray-400" datetime="2025-12-23">
      Dec 23, 2025
    </time>
  </a>
</article>

      
        
<article class="mb-4 pb-4 border-b border-gray-200 dark:border-gray-700 last:border-b-0 last:mb-0 last:pb-0">
  <a href="https://ravichaganti.com/blog/google-adk-runner-and-execution-architecture/" class="no-underline block group">
    
    <h4 class="text-sm font-bold text-gray-900 dark:text-gray-100 group-hover:text-primary dark:group-hover:text-blue-400 transition-colors line-clamp-2 mb-1">
      Google ADK - Runner and execution architecture
    </h4>

    
    <time class="text-xs text-gray-500 dark:text-gray-400" datetime="2025-12-18">
      Dec 18, 2025
    </time>
  </a>
</article>

      
        
<article class="mb-4 pb-4 border-b border-gray-200 dark:border-gray-700 last:border-b-0 last:mb-0 last:pb-0">
  <a href="https://ravichaganti.com/blog/google-adk-callbacks/" class="no-underline block group">
    
    <h4 class="text-sm font-bold text-gray-900 dark:text-gray-100 group-hover:text-primary dark:group-hover:text-blue-400 transition-colors line-clamp-2 mb-1">
      Google ADK - Callbacks
    </h4>

    
    <time class="text-xs text-gray-500 dark:text-gray-400" datetime="2025-12-12">
      Dec 12, 2025
    </time>
  </a>
</article>

      
        
<article class="mb-4 pb-4 border-b border-gray-200 dark:border-gray-700 last:border-b-0 last:mb-0 last:pb-0">
  <a href="https://ravichaganti.com/blog/google-adk-sessions-state-and-memory/" class="no-underline block group">
    
    <h4 class="text-sm font-bold text-gray-900 dark:text-gray-100 group-hover:text-primary dark:group-hover:text-blue-400 transition-colors line-clamp-2 mb-1">
      Google ADK - Sessions, state, and memory
    </h4>

    
    <time class="text-xs text-gray-500 dark:text-gray-400" datetime="2025-12-05">
      Dec 5, 2025
    </time>
  </a>
</article>

      
        
<article class="mb-4 pb-4 border-b border-gray-200 dark:border-gray-700 last:border-b-0 last:mb-0 last:pb-0">
  <a href="https://ravichaganti.com/blog/google-adk-types-of-agents/" class="no-underline block group">
    
    <h4 class="text-sm font-bold text-gray-900 dark:text-gray-100 group-hover:text-primary dark:group-hover:text-blue-400 transition-colors line-clamp-2 mb-1">
      Google ADK - types of agents
    </h4>

    
    <time class="text-xs text-gray-500 dark:text-gray-400" datetime="2025-12-03">
      Dec 3, 2025
    </time>
  </a>
</article>

      
    </div>
  </div>


        </div>
        <div class="sidebar-sticky-reinforced">
          


<div class="bg-white dark:bg-dark-bg-secondary rounded-xl shadow-md dark:shadow-lg dark:shadow-black/20 p-6 mb-6">
  <h3 class="font-semibold text-gray-900 dark:text-dark-text mb-4 flex items-center">
    <svg class="w-5 h-5 mr-2 text-gray-500 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"></path>
    </svg>
    Table of Contents
  </h3>

  <nav id="sidebar-toc" class="toc-sidebar text-sm max-h-[calc(100vh-200px)] overflow-y-auto custom-scrollbar">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#what-is-mcp">What is MCP?</a></li>
    <li><a href="#consuming-mcp-servers">Consuming MCP servers</a>
      <ul>
        <li><a href="#mcptoolset">McpToolset</a></li>
        <li><a href="#connecting-via-stdio">Connecting via Stdio</a></li>
        <li><a href="#connecting-via-sse">Connecting via SSE</a></li>
        <li><a href="#connecting-via-streamable-http">Connecting via Streamable HTTP</a></li>
        <li><a href="#filtering-tools">Filtering tools</a></li>
        <li><a href="#using-mcptoolset-outside-adk-web">Using McpToolset outside adk web</a></li>
        <li><a href="#connecting-to-multiple-mcp-servers">Connecting to multiple MCP servers</a></li>
      </ul>
    </li>
    <li><a href="#exposing-adk-tools-as-an-mcp-server">Exposing ADK tools as an MCP server</a>
      <ul>
        <li><a href="#building-the-mcp-server">Building the MCP server</a></li>
        <li><a href="#testing-with-an-adk-agent">Testing with an ADK agent</a></li>
        <li><a href="#using-fastmcp-for-simpler-server-creation">Using FastMCP for simpler server creation</a></li>
      </ul>
    </li>
    <li><a href="#key-considerations">Key considerations</a>
      <ul>
        <li><a href="#statefulness">Statefulness</a></li>
        <li><a href="#async-nature">Async nature</a></li>
        <li><a href="#deployment-considerations">Deployment considerations</a></li>
        <li><a href="#pre-built-mcp-tools">Pre-built MCP tools</a></li>
      </ul>
    </li>
    <li><a href="#putting-it-all-together">Putting it all together</a></li>
  </ul>
</nav>
  </nav>
</div>

<style>
  #sidebar-toc ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
  }

  #sidebar-toc ul ul {
    padding-left: 1rem;
    margin-top: 0.25rem;
    margin-bottom: 0.25rem;
    border-left: 1px solid #e5e7eb;
     
  }

  .dark #sidebar-toc ul ul {
    border-color: #374151;
     
  }

  #sidebar-toc li {
    margin-top: 0.5rem;
    margin-bottom: 0.5rem;
  }

  #sidebar-toc a {
    display: block;
    color: #4b5563;
     
    text-decoration: none;
    transition: all 0.2s;
    padding-left: 0.5rem;
    border-left: 2px solid transparent;
    margin-left: -1px;
     
  }

  #sidebar-toc a:hover {
    color: #1e40af;
     
    text-decoration: none;
  }

   
  #sidebar-toc a.active {
    color: #2563eb;
     
    font-weight: 600;
    border-left-color: #2563eb;
  }

   
  .dark #sidebar-toc a {
    color: #9ca3af;
     
  }

  .dark #sidebar-toc a:hover {
    color: #60a5fa;
     
  }

  .dark #sidebar-toc a.active {
    color: #60a5fa;
     
    border-left-color: #60a5fa;
  }

   
  .custom-scrollbar::-webkit-scrollbar {
    width: 4px;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    background-color: #e5e7eb;
    border-radius: 20px;
  }

  .dark .custom-scrollbar::-webkit-scrollbar-thumb {
    background-color: #374151;
  }
</style>


        </div>
      </aside>
    </div>
    
  </div>

  
  <script src="/js/collapse.js"></script>
  <script src="/js/code-copy.js"></script>
  <script src="/js/toc-scrollspy.js"></script>
  <script src="/js/heading-anchors.js"></script>
</article>

  </main>

  <footer class="bg-gray-900 dark:bg-dark-bg text-gray-300 dark:text-dark-text-secondary mt-16">
  <div class="container mx-auto px-4 py-8">
    <div class="text-center text-sm">
      <p>&copy; 2026 Ravikanth Chaganti. All rights reserved.</p>
    </div>
  </div>
</footer>


  
  <button id="back-to-top"
          class="fixed bottom-8 right-8 w-12 h-12 bg-primary text-white rounded-full shadow-lg hover:bg-blue-700 transition-all opacity-0 pointer-events-none z-40"
          aria-label="Back to top"
          title="Back to top">
    <svg class="w-6 h-6 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path>
    </svg>
  </button>

  
  

  
  <script>
    
    
    
  </script>

  
  
    <script src="/js/reading-progress.js"></script>
  

  
  <script src="/js/back-to-top.js"></script>

  
  <script src="/js/theme-toggle.js"></script>

  
  <script src="/js/cookie-consent.js"></script>

  
  

  
  <script
    data-goatcounter="https://ravichaganti.goatcounter.com/count"
    async
    src="//gc.zgo.at/count.js">
  </script>



  
  
<div id="cookie-consent-banner"
     class="hidden fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 shadow-lg z-50 transition-transform duration-300">
  <div class="container mx-auto px-4 py-2">
    <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-4">

      
      <div class="flex-1">
        <p class="text-xs sm:text-sm text-gray-700 dark:text-gray-200">
          This site may load third-party content (comments, embeds) that could set cookies.
          <a href="#"
             id="cookie-learn-more"
             class="text-primary hover:underline font-medium ml-1"
             onclick="document.getElementById('cookie-customize').click(); return false;">
            Learn more
          </a>
        </p>
      </div>

      
      <div class="flex flex-row gap-2 w-full sm:w-auto flex-shrink-0">
        <button id="cookie-reject-all"
                class="px-3 py-1 text-xs font-medium text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors">
          Reject
        </button>
        <button id="cookie-customize"
                class="px-3 py-1 text-xs font-medium text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors">
          Settings
        </button>
        <button id="cookie-accept-all"
                class="px-3 py-1 text-xs font-medium text-white bg-primary hover:bg-blue-700 rounded transition-colors">
          Accept
        </button>
      </div>
    </div>
  </div>
</div>


<div id="cookie-settings-modal"
     class="hidden fixed inset-0 bg-black bg-opacity-50 dark:bg-opacity-70 z-50 flex items-center justify-center p-4 overflow-y-auto">
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-4xl my-8">

    
    <div class="bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 px-4 py-3 rounded-t-lg">
      <div class="flex items-center justify-between">
        <h2 class="text-lg font-bold text-gray-900 dark:text-gray-100">
          Cookie Preferences
        </h2>
        <button id="cookie-modal-close"
                class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors"
                aria-label="Close">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
    </div>

    
    <div class="px-6 py-4 space-y-4 max-h-[calc(90vh-140px)] overflow-y-auto bg-white dark:bg-gray-800">

      
      <div class="text-sm text-gray-600 dark:text-gray-300">
        <p>
          Control what third-party content is loaded. We use privacy-friendly analytics with no cookies.
        </p>
      </div>

      
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">

        
        <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 bg-gray-50 dark:bg-gray-900">
          <div class="flex items-start justify-between gap-2 mb-2">
            <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">
              Essential
            </h3>
            <div class="flex items-center justify-center w-10 h-5 bg-primary rounded-full flex-shrink-0">
              <span class="text-xs font-medium text-white">ON</span>
            </div>
          </div>
          <p class="text-xs text-gray-600 dark:text-gray-300 mb-2">
            Required for the website to function. Cannot be disabled.
          </p>
          <ul class="text-xs text-gray-500 dark:text-gray-400 space-y-1">
            <li>• Theme preference</li>
            <li>• Privacy-friendly analytics</li>
          </ul>
        </div>

        
        <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 bg-white dark:bg-gray-900">
          <div class="flex items-start justify-between gap-2 mb-2">
            <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">
              Comments
            </h3>
            <label class="relative inline-block w-10 h-5 flex-shrink-0">
              <input type="checkbox"
                     id="consent-comments"
                     class="peer sr-only">
              <span class="absolute inset-0 bg-gray-300 dark:bg-gray-600 rounded-full cursor-pointer transition-colors peer-checked:bg-primary"></span>
              <span class="absolute left-0.5 top-0.5 w-4 h-4 bg-white rounded-full transition-transform peer-checked:translate-x-5"></span>
            </label>
          </div>
          <p class="text-xs text-gray-600 dark:text-gray-300 mb-2">
            Giscus comment system (GitHub Discussions).
          </p>
          <ul class="text-xs text-gray-500 dark:text-gray-400 space-y-1">
            <li>• Authentication cookies</li>
            <li>• GitHub privacy policy</li>
          </ul>
        </div>

        
        <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 bg-white dark:bg-gray-900">
          <div class="flex items-start justify-between gap-2 mb-2">
            <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">
              Embedded Content
            </h3>
            <label class="relative inline-block w-10 h-5 flex-shrink-0">
              <input type="checkbox"
                     id="consent-embeds"
                     class="peer sr-only">
              <span class="absolute inset-0 bg-gray-300 dark:bg-gray-600 rounded-full cursor-pointer transition-colors peer-checked:bg-primary"></span>
              <span class="absolute left-0.5 top-0.5 w-4 h-4 bg-white rounded-full transition-transform peer-checked:translate-x-5"></span>
            </label>
          </div>
          <p class="text-xs text-gray-600 dark:text-gray-300 mb-2">
            Videos, code snippets, presentations.
          </p>
          <ul class="text-xs text-gray-500 dark:text-gray-400 space-y-1">
            <li>• YouTube, Gists, SlideShare</li>
            <li>• May set tracking cookies</li>
          </ul>
        </div>
      </div>

      
      <div class="bg-blue-50 dark:bg-blue-950 dark:bg-opacity-50 border border-blue-200 dark:border-blue-800 rounded-lg p-4">
        <div class="flex items-start gap-3">
          <svg class="w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
          </svg>
          <div class="text-sm">
            <p class="font-semibold mb-1 text-blue-800 dark:text-blue-200">Privacy First</p>
            <p class="text-xs text-gray-700 dark:text-gray-300">
              No tracking cookies. Third-party content only loads with your consent. Preferences stored locally in your browser.
            </p>
          </div>
        </div>
      </div>
    </div>

    
    <div class="bg-gray-50 dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700 px-4 py-3 rounded-b-lg">
      <div class="flex justify-end">
        <button id="cookie-save-preferences"
                class="px-4 py-2 text-sm font-medium text-white bg-primary hover:bg-blue-700 dark:hover:bg-blue-600 rounded transition-colors shadow-sm">
          Save Preferences
        </button>
      </div>
    </div>
  </div>
</div>

</body>
</html>
